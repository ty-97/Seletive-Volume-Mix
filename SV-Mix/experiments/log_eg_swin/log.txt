[07/04 10:52:39] pytorchvideo INFO: Rank of current process: 0. World size: 4
[07/04 10:52:39] pytorchvideo INFO: Environment info:
----------------------  ---------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.0 (default, Nov 15 2020, 14:28:56) [GCC 7.3.0]
numpy                   1.24.2
PyTorch                 2.0.0+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 3090 (arch=8.6)
CUDA_HOME               /usr
Pillow                  10.0.1
torchvision             0.15.1+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.10
----------------------  ---------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[07/04 10:52:39] pytorchvideo INFO: Command line arguments: Namespace(config_file='experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml', resume=False, eval_only=False, num_gpus=4, repeat_time=1, num_machines=1, machine_rank=0, dist_url='auto', opts=[])
[07/04 10:52:39] pytorchvideo INFO: Contents of args.config_file=experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml:
DATASET:
  NAME: 'VideoClsDataset'

DATALOADER:
  TRAIN_BATCH_SIZE: 8
  TEST_BATCH_SIZE: 8
  TOTAL_BATCH_SIZE: 32
  NUM_WORKERS: 4
  ROOT_PATH: '/data/tanyi/EGTEA_Gaze+'
  TRAIN_LIST_FILE: 'trainValTest/train1.txt'
  TEST_LIST_FILE: 'trainValTest/val1.txt'
  FORMAT: 'DECORD_.mp4'
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  CLIP_LENGTH: 1
  NUM_STEPS: 1

ENGINE:
  NAME: 'DefaultTrainer'
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True

TRANSFORM:
  NAME: 'SIFARTransform'
  CROP_SIZE: 224
  TEST_CROP_SIZE: 224
  NO_HORIZONTAL_FLIP: False
  TIME_DIM: 'T'
  MIXUP_PROB: 1.
  SWITCH_PROB: .5
  MASK_MOTION_CUT: 1.
  MIXUP_LABELSMOOTHING: .1


MODEL:
  NAME: 'VIDEO_SWIN'
  ARCH: 'video_swin_vit_s_p4_w7'
  NUM_CLASSES: 48
  DROP_PATH_RATIO: 0.2
  WEIGHTS: '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
  REMOVE_FC: True
  FROZEN_BN: False
  TRANSFER_WEIGHTS: True

SOLVER:
  NAME: 'AdamW'
  NAME_MIXBLOCK: 'SGD'
  PARAMS: 'default'
  EPOCH: 50
  CHECKPOINT_PERIOD: 1
  EVAL_PERIOD: 5
  DENSE_EVAL_EPOCH: 40
  BASE_LR: 2e-4
  BASE_LR_MIXBLOCK: 0.02
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  MOMENTUM: 0.9
  ALPHA: 0.99
  BETAS: [0.9, 0.999]
  WRITE_PERIOD: 50
  AUTO_LR: False
  GRAD_CLIP: 1.
  GRAD_CLIP_MIXBLOCK: 20.

LR_SCHEDULER:
  NAME: 'WarmupCosineLR'
  WARMUP_EPOCH: 5

LOSSES:
  # NAMES: ['LabelSmoothing']
  # LABELSMOOTHING: 0.1
  NAMES: ['SoftTargetCrossEntropy']


INFERENCE:
  NAME: 'ClsEvaluator'
[07/04 10:52:39] pytorchvideo INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  CLIP_LENGTH: 1
  FORMAT: DECORD_.mp4
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  NUM_STEPS: 1
  NUM_WORKERS: 4
  ROOT_PATH: /data/tanyi/EGTEA_Gaze+
  SHUFFLE: True
  TEST_BATCH_SIZE: 8
  TEST_LIST_FILE: trainValTest/val1.txt
  TOTAL_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
  TRAIN_LIST_FILE: trainValTest/train1.txt
DATASET:
  NAME: VideoClsDataset
ENGINE:
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True
  NAME: DefaultTrainer
INFERENCE:
  NAME: ClsEvaluator
LOSSES:
  LABELSMOOTHING: 0.2
  NAMES: ['SoftTargetCrossEntropy']
  WEIGHTS: [1.0]
LR_SCHEDULER:
  GAMMA: 0.1
  MILESTONES: (3,)
  NAME: WarmupCosineLR
  STEP_SIZE: 3
  WARMUP_EPOCH: 5
MODEL:
  ARCH: video_swin_vit_s_p4_w7
  ARCH_CFGS: []
  DEVICE: cuda
  DROPOUT_RATIO: 0.0
  DROP_PATH_RATIO: 0.2
  EARLY_STRIDE: 1
  FROZEN_BN: False
  NAME: VIDEO_SWIN
  NUM_CLASSES: 48
  REMOVE_FC: True
  TRANSFER_WEIGHTS: True
  WEIGHTS: /data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth
OUTPUT_DIR: experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002
SEED: -1
SOLVER:
  ALPHA: 0.99
  AUTO_LR: False
  BASE_LR: 0.0002
  BASE_LR_MIXBLOCK: 0.02
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DENSE_EVAL_EPOCH: 40
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 5
  FC_LR5: False
  GRAD_CLIP: 1.0
  GRAD_CLIP_MIXBLOCK: 20.0
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.9
  NAME: AdamW
  NAME_MIXBLOCK: SGD
  NESTEROV: False
  NORM_TYPE: 2.0
  PARAMS: default
  REGULARIZE: 1.0
  SNAPSHOT: 
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  WEIGHT_DECAY_NORM: 0.0
  WRITE_PERIOD: 50
TRANSFORM:
  AUTO_AUG: rand-m7-n4-mstd0.5-inc1
  CROP_SIZE: 224
  MASK_MIX: 0.0
  MASK_MOTION_CUT: 1.0
  MASK_MOTION_CUT_STATIC: 0.0
  MIXUP_LABELSMOOTHING: 0.1
  MIXUP_PROB: 1.0
  MOTION_CUT: 0.0
  MOTION_CUT_STATIC: 0.0
  NAME: SIFARTransform
  NO_HORIZONTAL_FLIP: False
  SALIENCY_CUT: 0.0
  SWITCH_PROB: 0.5
  TEST_CROP_SIZE: 224
  TIME_DIM: T
  USE_FLOW: False
VERSION: 1
[07/04 10:52:39] pytorchvideo INFO: Full config saved to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/config.yaml
[07/04 10:52:39] pts.utils.env INFO: Using a generated random seed 42172212
[07/04 10:56:54] pytorchvideo INFO: Rank of current process: 0. World size: 4
[07/04 10:56:54] pytorchvideo INFO: Environment info:
----------------------  ---------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.0 (default, Nov 15 2020, 14:28:56) [GCC 7.3.0]
numpy                   1.24.2
PyTorch                 2.0.0+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 3090 (arch=8.6)
CUDA_HOME               /usr
Pillow                  10.0.1
torchvision             0.15.1+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.10
----------------------  ---------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[07/04 10:56:54] pytorchvideo INFO: Command line arguments: Namespace(config_file='experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml', resume=False, eval_only=False, num_gpus=4, repeat_time=1, num_machines=1, machine_rank=0, dist_url='auto', opts=[])
[07/04 10:56:54] pytorchvideo INFO: Contents of args.config_file=experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml:
DATASET:
  NAME: 'VideoClsDataset'

DATALOADER:
  TRAIN_BATCH_SIZE: 8
  TEST_BATCH_SIZE: 8
  TOTAL_BATCH_SIZE: 32
  NUM_WORKERS: 4
  ROOT_PATH: '/data/tanyi/EGTEA_Gaze+'
  TRAIN_LIST_FILE: 'trainValTest/train1.txt'
  TEST_LIST_FILE: 'trainValTest/val1.txt'
  FORMAT: 'DECORD_.mp4'
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  CLIP_LENGTH: 1
  NUM_STEPS: 1

ENGINE:
  NAME: 'DefaultTrainer'
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True

TRANSFORM:
  NAME: 'SIFARTransform'
  CROP_SIZE: 224
  TEST_CROP_SIZE: 224
  NO_HORIZONTAL_FLIP: False
  TIME_DIM: 'T'
  MIXUP_PROB: 1.
  SWITCH_PROB: .5
  MASK_MOTION_CUT: 1.
  MIXUP_LABELSMOOTHING: .1


MODEL:
  NAME: 'VIDEO_SWIN'
  ARCH: 'video_swin_vit_s_p4_w7'
  NUM_CLASSES: 48
  DROP_PATH_RATIO: 0.2
  WEIGHTS: '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
  REMOVE_FC: True
  FROZEN_BN: False
  TRANSFER_WEIGHTS: True

SOLVER:
  NAME: 'AdamW'
  NAME_MIXBLOCK: 'SGD'
  PARAMS: 'default'
  EPOCH: 50
  CHECKPOINT_PERIOD: 1
  EVAL_PERIOD: 5
  DENSE_EVAL_EPOCH: 40
  BASE_LR: 2e-4
  BASE_LR_MIXBLOCK: 0.02
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  MOMENTUM: 0.9
  ALPHA: 0.99
  BETAS: [0.9, 0.999]
  WRITE_PERIOD: 50
  AUTO_LR: False
  GRAD_CLIP: 1.
  GRAD_CLIP_MIXBLOCK: 20.

LR_SCHEDULER:
  NAME: 'WarmupCosineLR'
  WARMUP_EPOCH: 5

LOSSES:
  # NAMES: ['LabelSmoothing']
  # LABELSMOOTHING: 0.1
  NAMES: ['SoftTargetCrossEntropy']


INFERENCE:
  NAME: 'ClsEvaluator'
[07/04 10:56:54] pytorchvideo INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  CLIP_LENGTH: 1
  FORMAT: DECORD_.mp4
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  NUM_STEPS: 1
  NUM_WORKERS: 4
  ROOT_PATH: /data/tanyi/EGTEA_Gaze+
  SHUFFLE: True
  TEST_BATCH_SIZE: 8
  TEST_LIST_FILE: trainValTest/val1.txt
  TOTAL_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
  TRAIN_LIST_FILE: trainValTest/train1.txt
DATASET:
  NAME: VideoClsDataset
ENGINE:
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True
  NAME: DefaultTrainer
INFERENCE:
  NAME: ClsEvaluator
LOSSES:
  LABELSMOOTHING: 0.2
  NAMES: ['SoftTargetCrossEntropy']
  WEIGHTS: [1.0]
LR_SCHEDULER:
  GAMMA: 0.1
  MILESTONES: (3,)
  NAME: WarmupCosineLR
  STEP_SIZE: 3
  WARMUP_EPOCH: 5
MODEL:
  ARCH: video_swin_vit_s_p4_w7
  ARCH_CFGS: []
  DEVICE: cuda
  DROPOUT_RATIO: 0.0
  DROP_PATH_RATIO: 0.2
  EARLY_STRIDE: 1
  FROZEN_BN: False
  NAME: VIDEO_SWIN
  NUM_CLASSES: 48
  REMOVE_FC: True
  TRANSFER_WEIGHTS: True
  WEIGHTS: /data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth
OUTPUT_DIR: experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002
SEED: -1
SOLVER:
  ALPHA: 0.99
  AUTO_LR: False
  BASE_LR: 0.0002
  BASE_LR_MIXBLOCK: 0.02
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DENSE_EVAL_EPOCH: 40
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 5
  FC_LR5: False
  GRAD_CLIP: 1.0
  GRAD_CLIP_MIXBLOCK: 20.0
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.9
  NAME: AdamW
  NAME_MIXBLOCK: SGD
  NESTEROV: False
  NORM_TYPE: 2.0
  PARAMS: default
  REGULARIZE: 1.0
  SNAPSHOT: 
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  WEIGHT_DECAY_NORM: 0.0
  WRITE_PERIOD: 50
TRANSFORM:
  AUTO_AUG: rand-m7-n4-mstd0.5-inc1
  CROP_SIZE: 224
  MASK_MIX: 0.0
  MASK_MOTION_CUT: 1.0
  MASK_MOTION_CUT_STATIC: 0.0
  MIXUP_LABELSMOOTHING: 0.1
  MIXUP_PROB: 1.0
  MOTION_CUT: 0.0
  MOTION_CUT_STATIC: 0.0
  NAME: SIFARTransform
  NO_HORIZONTAL_FLIP: False
  SALIENCY_CUT: 0.0
  SWITCH_PROB: 0.5
  TEST_CROP_SIZE: 224
  TIME_DIM: T
  USE_FLOW: False
VERSION: 1
[07/04 10:56:54] pytorchvideo INFO: Full config saved to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/config.yaml
[07/04 10:56:54] pts.utils.env INFO: Using a generated random seed 57220309
[07/04 11:02:51] pytorchvideo INFO: Rank of current process: 0. World size: 4
[07/04 11:02:51] pytorchvideo INFO: Environment info:
----------------------  ---------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.0 (default, Nov 15 2020, 14:28:56) [GCC 7.3.0]
numpy                   1.24.2
PyTorch                 2.0.0+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 3090 (arch=8.6)
CUDA_HOME               /usr
Pillow                  10.0.1
torchvision             0.15.1+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.10
----------------------  ---------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[07/04 11:02:51] pytorchvideo INFO: Command line arguments: Namespace(config_file='experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml', resume=False, eval_only=False, num_gpus=4, repeat_time=1, num_machines=1, machine_rank=0, dist_url='auto', opts=[])
[07/04 11:02:51] pytorchvideo INFO: Contents of args.config_file=experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml:
DATASET:
  NAME: 'VideoClsDataset'

DATALOADER:
  TRAIN_BATCH_SIZE: 8
  TEST_BATCH_SIZE: 8
  TOTAL_BATCH_SIZE: 32
  NUM_WORKERS: 4
  ROOT_PATH: '/data/tanyi/EGTEA_Gaze+'
  TRAIN_LIST_FILE: 'trainValTest/train1.txt'
  TEST_LIST_FILE: 'trainValTest/val1.txt'
  FORMAT: 'DECORD_.mp4'
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  CLIP_LENGTH: 1
  NUM_STEPS: 1

ENGINE:
  NAME: 'DefaultTrainer'
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True

TRANSFORM:
  NAME: 'SIFARTransform'
  CROP_SIZE: 224
  TEST_CROP_SIZE: 224
  NO_HORIZONTAL_FLIP: False
  TIME_DIM: 'T'
  MIXUP_PROB: 1.
  SWITCH_PROB: .5
  MASK_MOTION_CUT: 1.
  MIXUP_LABELSMOOTHING: .1


MODEL:
  NAME: 'VIDEO_SWIN'
  ARCH: 'video_swin_vit_s_p4_w7'
  NUM_CLASSES: 48
  DROP_PATH_RATIO: 0.2
  WEIGHTS: '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
  REMOVE_FC: True
  FROZEN_BN: False
  TRANSFER_WEIGHTS: True

SOLVER:
  NAME: 'AdamW'
  NAME_MIXBLOCK: 'SGD'
  PARAMS: 'default'
  EPOCH: 50
  CHECKPOINT_PERIOD: 1
  EVAL_PERIOD: 5
  DENSE_EVAL_EPOCH: 40
  BASE_LR: 2e-4
  BASE_LR_MIXBLOCK: 0.02
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  MOMENTUM: 0.9
  ALPHA: 0.99
  BETAS: [0.9, 0.999]
  WRITE_PERIOD: 50
  AUTO_LR: False
  GRAD_CLIP: 1.
  GRAD_CLIP_MIXBLOCK: 20.

LR_SCHEDULER:
  NAME: 'WarmupCosineLR'
  WARMUP_EPOCH: 5

LOSSES:
  # NAMES: ['LabelSmoothing']
  # LABELSMOOTHING: 0.1
  NAMES: ['SoftTargetCrossEntropy']


INFERENCE:
  NAME: 'ClsEvaluator'
[07/04 11:02:51] pytorchvideo INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  CLIP_LENGTH: 1
  FORMAT: DECORD_.mp4
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  NUM_STEPS: 1
  NUM_WORKERS: 4
  ROOT_PATH: /data/tanyi/EGTEA_Gaze+
  SHUFFLE: True
  TEST_BATCH_SIZE: 8
  TEST_LIST_FILE: trainValTest/val1.txt
  TOTAL_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
  TRAIN_LIST_FILE: trainValTest/train1.txt
DATASET:
  NAME: VideoClsDataset
ENGINE:
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True
  NAME: DefaultTrainer
INFERENCE:
  NAME: ClsEvaluator
LOSSES:
  LABELSMOOTHING: 0.2
  NAMES: ['SoftTargetCrossEntropy']
  WEIGHTS: [1.0]
LR_SCHEDULER:
  GAMMA: 0.1
  MILESTONES: (3,)
  NAME: WarmupCosineLR
  STEP_SIZE: 3
  WARMUP_EPOCH: 5
MODEL:
  ARCH: video_swin_vit_s_p4_w7
  ARCH_CFGS: []
  DEVICE: cuda
  DROPOUT_RATIO: 0.0
  DROP_PATH_RATIO: 0.2
  EARLY_STRIDE: 1
  FROZEN_BN: False
  NAME: VIDEO_SWIN
  NUM_CLASSES: 48
  REMOVE_FC: True
  TRANSFER_WEIGHTS: True
  WEIGHTS: /data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth
OUTPUT_DIR: experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002
SEED: -1
SOLVER:
  ALPHA: 0.99
  AUTO_LR: False
  BASE_LR: 0.0002
  BASE_LR_MIXBLOCK: 0.02
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DENSE_EVAL_EPOCH: 40
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 5
  FC_LR5: False
  GRAD_CLIP: 1.0
  GRAD_CLIP_MIXBLOCK: 20.0
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.9
  NAME: AdamW
  NAME_MIXBLOCK: SGD
  NESTEROV: False
  NORM_TYPE: 2.0
  PARAMS: default
  REGULARIZE: 1.0
  SNAPSHOT: 
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  WEIGHT_DECAY_NORM: 0.0
  WRITE_PERIOD: 50
TRANSFORM:
  AUTO_AUG: rand-m7-n4-mstd0.5-inc1
  CROP_SIZE: 224
  MASK_MIX: 0.0
  MASK_MOTION_CUT: 1.0
  MASK_MOTION_CUT_STATIC: 0.0
  MIXUP_LABELSMOOTHING: 0.1
  MIXUP_PROB: 1.0
  MOTION_CUT: 0.0
  MOTION_CUT_STATIC: 0.0
  NAME: SIFARTransform
  NO_HORIZONTAL_FLIP: False
  SALIENCY_CUT: 0.0
  SWITCH_PROB: 0.5
  TEST_CROP_SIZE: 224
  TIME_DIM: T
  USE_FLOW: False
VERSION: 1
[07/04 11:02:51] pytorchvideo INFO: Full config saved to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/config.yaml
[07/04 11:02:51] pts.utils.env INFO: Using a generated random seed 54362135
[07/04 11:03:06] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 11:03:06] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 11:03:06] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 11:03:24] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 11:03:24] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 11:03:24] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 11:03:24] pts.engine.defaults INFO: Model:
VIDEO_SWIN(
  (patch_embed): PatchEmbed3D(
    (proj): Conv3d(3, 96, kernel_size=(2, 4, 4), stride=(2, 4, 4))
    (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (layers): ModuleList(
    (0): BasicLayer(
      (blocks): ModuleList(
        (0): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=384, out_features=192, bias=False)
        (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
    (1): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=192, out_features=576, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=192, out_features=192, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=768, out_features=192, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=768, out_features=384, bias=False)
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      )
    )
    (2): BasicLayer(
      (blocks): ModuleList(
        (0-17): 18 x SwinTransformerBlock3D(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=384, out_features=384, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1536, out_features=384, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=1536, out_features=768, bias=False)
        (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
      )
    )
    (3): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  (avgpool): AdaptiveAvgPool3d(output_size=1)
  (fc): Linear(in_features=768, out_features=48, bias=True)
)
[07/04 11:03:33] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/04 11:03:33] pts.engine.train_loop INFO: Starting training from iteration 0
[07/04 11:13:25] pytorchvideo INFO: Rank of current process: 0. World size: 4
[07/04 11:13:26] pytorchvideo INFO: Environment info:
----------------------  ---------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.0 (default, Nov 15 2020, 14:28:56) [GCC 7.3.0]
numpy                   1.24.2
PyTorch                 2.0.0+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 3090 (arch=8.6)
CUDA_HOME               /usr
Pillow                  10.0.1
torchvision             0.15.1+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.10
----------------------  ---------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[07/04 11:13:26] pytorchvideo INFO: Command line arguments: Namespace(config_file='experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml', resume=False, eval_only=False, num_gpus=4, repeat_time=1, num_machines=1, machine_rank=0, dist_url='auto', opts=[])
[07/04 11:13:26] pytorchvideo INFO: Contents of args.config_file=experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml:
DATASET:
  NAME: 'VideoClsDataset'

DATALOADER:
  TRAIN_BATCH_SIZE: 8
  TEST_BATCH_SIZE: 8
  TOTAL_BATCH_SIZE: 32
  NUM_WORKERS: 4
  ROOT_PATH: '/data/tanyi/EGTEA_Gaze+'
  TRAIN_LIST_FILE: 'trainValTest/train1.txt'
  TEST_LIST_FILE: 'trainValTest/val1.txt'
  FORMAT: 'DECORD_.mp4'
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  CLIP_LENGTH: 1
  NUM_STEPS: 1

ENGINE:
  NAME: 'DefaultTrainer'
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True

TRANSFORM:
  NAME: 'SIFARTransform'
  CROP_SIZE: 224
  TEST_CROP_SIZE: 224
  NO_HORIZONTAL_FLIP: False
  TIME_DIM: 'T'
  MIXUP_PROB: 1.
  SWITCH_PROB: .5
  MASK_MOTION_CUT: 1.
  MIXUP_LABELSMOOTHING: .1


MODEL:
  NAME: 'VIDEO_SWIN'
  ARCH: 'video_swin_vit_s_p4_w7'
  NUM_CLASSES: 48
  DROP_PATH_RATIO: 0.2
  WEIGHTS: '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
  REMOVE_FC: True
  FROZEN_BN: False
  TRANSFER_WEIGHTS: True

SOLVER:
  NAME: 'AdamW'
  NAME_MIXBLOCK: 'SGD'
  PARAMS: 'default'
  EPOCH: 50
  CHECKPOINT_PERIOD: 1
  EVAL_PERIOD: 5
  DENSE_EVAL_EPOCH: 40
  BASE_LR: 2e-4
  BASE_LR_MIXBLOCK: 0.02
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  MOMENTUM: 0.9
  ALPHA: 0.99
  BETAS: [0.9, 0.999]
  WRITE_PERIOD: 50
  AUTO_LR: False
  GRAD_CLIP: 1.
  GRAD_CLIP_MIXBLOCK: 20.

LR_SCHEDULER:
  NAME: 'WarmupCosineLR'
  WARMUP_EPOCH: 5

LOSSES:
  # NAMES: ['LabelSmoothing']
  # LABELSMOOTHING: 0.1
  NAMES: ['SoftTargetCrossEntropy']


INFERENCE:
  NAME: 'ClsEvaluator'
[07/04 11:13:26] pytorchvideo INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  CLIP_LENGTH: 1
  FORMAT: DECORD_.mp4
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  NUM_STEPS: 1
  NUM_WORKERS: 4
  ROOT_PATH: /data/tanyi/EGTEA_Gaze+
  SHUFFLE: True
  TEST_BATCH_SIZE: 8
  TEST_LIST_FILE: trainValTest/val1.txt
  TOTAL_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
  TRAIN_LIST_FILE: trainValTest/train1.txt
DATASET:
  NAME: VideoClsDataset
ENGINE:
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True
  NAME: DefaultTrainer
INFERENCE:
  NAME: ClsEvaluator
LOSSES:
  LABELSMOOTHING: 0.2
  NAMES: ['SoftTargetCrossEntropy']
  WEIGHTS: [1.0]
LR_SCHEDULER:
  GAMMA: 0.1
  MILESTONES: (3,)
  NAME: WarmupCosineLR
  STEP_SIZE: 3
  WARMUP_EPOCH: 5
MODEL:
  ARCH: video_swin_vit_s_p4_w7
  ARCH_CFGS: []
  DEVICE: cuda
  DROPOUT_RATIO: 0.0
  DROP_PATH_RATIO: 0.2
  EARLY_STRIDE: 1
  FROZEN_BN: False
  NAME: VIDEO_SWIN
  NUM_CLASSES: 48
  REMOVE_FC: True
  TRANSFER_WEIGHTS: True
  WEIGHTS: /data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth
OUTPUT_DIR: experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002
SEED: -1
SOLVER:
  ALPHA: 0.99
  AUTO_LR: False
  BASE_LR: 0.0002
  BASE_LR_MIXBLOCK: 0.02
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DENSE_EVAL_EPOCH: 40
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 5
  FC_LR5: False
  GRAD_CLIP: 1.0
  GRAD_CLIP_MIXBLOCK: 20.0
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.9
  NAME: AdamW
  NAME_MIXBLOCK: SGD
  NESTEROV: False
  NORM_TYPE: 2.0
  PARAMS: default
  REGULARIZE: 1.0
  SNAPSHOT: 
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  WEIGHT_DECAY_NORM: 0.0
  WRITE_PERIOD: 50
TRANSFORM:
  AUTO_AUG: rand-m7-n4-mstd0.5-inc1
  CROP_SIZE: 224
  MASK_MIX: 0.0
  MASK_MOTION_CUT: 1.0
  MASK_MOTION_CUT_STATIC: 0.0
  MIXUP_LABELSMOOTHING: 0.1
  MIXUP_PROB: 1.0
  MOTION_CUT: 0.0
  MOTION_CUT_STATIC: 0.0
  NAME: SIFARTransform
  NO_HORIZONTAL_FLIP: False
  SALIENCY_CUT: 0.0
  SWITCH_PROB: 0.5
  TEST_CROP_SIZE: 224
  TIME_DIM: T
  USE_FLOW: False
VERSION: 1
[07/04 11:13:26] pytorchvideo INFO: Full config saved to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/config.yaml
[07/04 11:13:26] pts.utils.env INFO: Using a generated random seed 28958282
[07/04 11:13:42] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 11:13:42] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 11:13:42] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 11:14:00] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 11:14:00] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 11:14:00] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 11:14:00] pts.engine.defaults INFO: Model:
VIDEO_SWIN(
  (patch_embed): PatchEmbed3D(
    (proj): Conv3d(3, 96, kernel_size=(2, 4, 4), stride=(2, 4, 4))
    (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (layers): ModuleList(
    (0): BasicLayer(
      (blocks): ModuleList(
        (0): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=384, out_features=192, bias=False)
        (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
    (1): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=192, out_features=576, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=192, out_features=192, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=768, out_features=192, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=768, out_features=384, bias=False)
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      )
    )
    (2): BasicLayer(
      (blocks): ModuleList(
        (0-17): 18 x SwinTransformerBlock3D(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=384, out_features=384, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1536, out_features=384, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=1536, out_features=768, bias=False)
        (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
      )
    )
    (3): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  (avgpool): AdaptiveAvgPool3d(output_size=1)
  (fc): Linear(in_features=768, out_features=48, bias=True)
)
[07/04 11:14:08] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/04 11:14:08] pts.engine.train_loop INFO: Starting training from iteration 0
[07/04 11:14:45] pts.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/engine/train_loop.py", line 151, in train
    self.run_step()
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/engine/defaults.py", line 432, in run_step
    x, label, x_ofl, label_ofl, mask_loss = self.mixup(data[kfg.FRAMES], data[kfg.LABELS])
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/transform/maskmotioncut.py", line 710, in __call__
    lam, lam_ofl, rand_index_ol, rand_index_ofl, x_ol, x_ofl, mask_loss = self._mix_batch(x,target)
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/transform/maskmotioncut.py", line 629, in _mix_batch
    mask_ol_s = self.mix_block_s(feature_map,lam,rand_index_ol,(h//h_f,t//t_f),use_cutmix)[0].clone().detach()
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/transform/maskmotioncut.py", line 98, in forward
    v_ = self.value(v_.transpose(1,2)).transpose(1,2).contiguous().view(n, 1, -1)  # [N, 1, T]
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: Expected size for first two dimensions of batch2 tensor to be: [8, 769] but got: [8, 2049].
[07/04 11:14:45] pts.engine.hooks INFO: Total training time: 0:00:36 (0:00:00 on hooks)
[07/04 11:14:45] pts.engine.hooks INFO: Best accuracy 0.000%
[07/04 11:14:45] pts.utils.events INFO:  iter: 0 -- [0/259]    lr: N/A  max_mem: 3267M
[07/04 13:50:44] pytorchvideo INFO: Rank of current process: 0. World size: 4
[07/04 13:51:17] pytorchvideo INFO: Rank of current process: 0. World size: 4
[07/04 13:51:17] pytorchvideo INFO: Environment info:
----------------------  ---------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.0 (default, Nov 15 2020, 14:28:56) [GCC 7.3.0]
numpy                   1.24.2
PyTorch                 2.0.0+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 3090 (arch=8.6)
CUDA_HOME               /usr
Pillow                  10.0.1
torchvision             0.15.1+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.10
----------------------  ---------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[07/04 13:51:17] pytorchvideo INFO: Command line arguments: Namespace(config_file='experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml', resume=False, eval_only=False, num_gpus=4, repeat_time=1, num_machines=1, machine_rank=0, dist_url='auto', opts=[])
[07/04 13:51:17] pytorchvideo INFO: Contents of args.config_file=experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml:
DATASET:
  NAME: 'VideoClsDataset'

DATALOADER:
  TRAIN_BATCH_SIZE: 8
  TEST_BATCH_SIZE: 8
  TOTAL_BATCH_SIZE: 32
  NUM_WORKERS: 4
  ROOT_PATH: '/data/tanyi/EGTEA_Gaze+'
  TRAIN_LIST_FILE: 'trainValTest/train1.txt'
  TEST_LIST_FILE: 'trainValTest/val1.txt'
  FORMAT: 'DECORD_.mp4'
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  CLIP_LENGTH: 1
  NUM_STEPS: 1

ENGINE:
  NAME: 'DefaultTrainer'
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True

TRANSFORM:
  NAME: 'SIFARTransform'
  CROP_SIZE: 224
  TEST_CROP_SIZE: 224
  NO_HORIZONTAL_FLIP: False
  TIME_DIM: 'T'
  MIXUP_PROB: 1.
  SWITCH_PROB: .5
  MASK_MOTION_CUT: 1.
  MIXUP_LABELSMOOTHING: .1


MODEL:
  NAME: 'VIDEO_SWIN'
  ARCH: 'video_swin_vit_s_p4_w7'
  NUM_CLASSES: 48
  DROP_PATH_RATIO: 0.2
  WEIGHTS: '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
  REMOVE_FC: True
  FROZEN_BN: False
  TRANSFER_WEIGHTS: True

SOLVER:
  NAME: 'AdamW'
  NAME_MIXBLOCK: 'SGD'
  PARAMS: 'default'
  EPOCH: 50
  CHECKPOINT_PERIOD: 1
  EVAL_PERIOD: 5
  DENSE_EVAL_EPOCH: 40
  BASE_LR: 2e-4
  BASE_LR_MIXBLOCK: 0.02
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  MOMENTUM: 0.9
  ALPHA: 0.99
  BETAS: [0.9, 0.999]
  WRITE_PERIOD: 50
  AUTO_LR: False
  GRAD_CLIP: 1.
  GRAD_CLIP_MIXBLOCK: 20.

LR_SCHEDULER:
  NAME: 'WarmupCosineLR'
  WARMUP_EPOCH: 5

LOSSES:
  # NAMES: ['LabelSmoothing']
  # LABELSMOOTHING: 0.1
  NAMES: ['SoftTargetCrossEntropy']


INFERENCE:
  NAME: 'ClsEvaluator'
[07/04 13:51:17] pytorchvideo INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  CLIP_LENGTH: 1
  FORMAT: DECORD_.mp4
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  NUM_STEPS: 1
  NUM_WORKERS: 4
  ROOT_PATH: /data/tanyi/EGTEA_Gaze+
  SHUFFLE: True
  TEST_BATCH_SIZE: 8
  TEST_LIST_FILE: trainValTest/val1.txt
  TOTAL_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
  TRAIN_LIST_FILE: trainValTest/train1.txt
DATASET:
  NAME: VideoClsDataset
ENGINE:
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True
  NAME: DefaultTrainer
INFERENCE:
  NAME: ClsEvaluator
LOSSES:
  LABELSMOOTHING: 0.2
  NAMES: ['SoftTargetCrossEntropy']
  WEIGHTS: [1.0]
LR_SCHEDULER:
  GAMMA: 0.1
  MILESTONES: (3,)
  NAME: WarmupCosineLR
  STEP_SIZE: 3
  WARMUP_EPOCH: 5
MODEL:
  ARCH: video_swin_vit_s_p4_w7
  ARCH_CFGS: []
  DEVICE: cuda
  DROPOUT_RATIO: 0.0
  DROP_PATH_RATIO: 0.2
  EARLY_STRIDE: 1
  FROZEN_BN: False
  NAME: VIDEO_SWIN
  NUM_CLASSES: 48
  REMOVE_FC: True
  TRANSFER_WEIGHTS: True
  WEIGHTS: /data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth
OUTPUT_DIR: experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002
SEED: -1
SOLVER:
  ALPHA: 0.99
  AUTO_LR: False
  BASE_LR: 0.0002
  BASE_LR_MIXBLOCK: 0.02
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DENSE_EVAL_EPOCH: 40
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 5
  FC_LR5: False
  GRAD_CLIP: 1.0
  GRAD_CLIP_MIXBLOCK: 20.0
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.9
  NAME: AdamW
  NAME_MIXBLOCK: SGD
  NESTEROV: False
  NORM_TYPE: 2.0
  PARAMS: default
  REGULARIZE: 1.0
  SNAPSHOT: 
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  WEIGHT_DECAY_NORM: 0.0
  WRITE_PERIOD: 50
TRANSFORM:
  AUTO_AUG: rand-m7-n4-mstd0.5-inc1
  CROP_SIZE: 224
  MASK_MIX: 0.0
  MASK_MOTION_CUT: 1.0
  MASK_MOTION_CUT_STATIC: 0.0
  MIXUP_LABELSMOOTHING: 0.1
  MIXUP_PROB: 1.0
  MOTION_CUT: 0.0
  MOTION_CUT_STATIC: 0.0
  NAME: SIFARTransform
  NO_HORIZONTAL_FLIP: False
  SALIENCY_CUT: 0.0
  SWITCH_PROB: 0.5
  TEST_CROP_SIZE: 224
  TIME_DIM: T
  USE_FLOW: False
VERSION: 1
[07/04 13:51:17] pytorchvideo INFO: Full config saved to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/config.yaml
[07/04 13:51:17] pts.utils.env INFO: Using a generated random seed 18238185
[07/04 13:51:35] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 13:51:35] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 13:51:35] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 13:51:52] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 13:51:52] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 13:51:52] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 13:51:52] pts.engine.defaults INFO: Model:
VIDEO_SWIN(
  (patch_embed): PatchEmbed3D(
    (proj): Conv3d(3, 96, kernel_size=(2, 4, 4), stride=(2, 4, 4))
    (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (layers): ModuleList(
    (0): BasicLayer(
      (blocks): ModuleList(
        (0): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=384, out_features=192, bias=False)
        (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
    (1): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=192, out_features=576, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=192, out_features=192, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=768, out_features=192, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=768, out_features=384, bias=False)
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      )
    )
    (2): BasicLayer(
      (blocks): ModuleList(
        (0-17): 18 x SwinTransformerBlock3D(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=384, out_features=384, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1536, out_features=384, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=1536, out_features=768, bias=False)
        (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
      )
    )
    (3): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  (avgpool): AdaptiveAvgPool3d(output_size=1)
  (fc): Linear(in_features=768, out_features=48, bias=True)
)
[07/04 13:52:01] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/04 13:52:01] pts.engine.train_loop INFO: Starting training from iteration 0
[07/04 13:52:36] pts.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 324, in _compile
    out_code = transform_code_object(code, transform)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/bytecode_transformation.py", line 445, in transform_code_object
    transformations(instructions, code_options)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 299, in transform
    tracer = InstructionTranslator(
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 1670, in __init__
    self.symbolic_locals = collections.OrderedDict(
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 1673, in <genexpr>
    VariableBuilder(
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/variables/builder.py", line 172, in __call__
    return self._wrap(value).clone(**self.options())
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/variables/builder.py", line 307, in _wrap
    result = {
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/variables/builder.py", line 308, in <dictcomp>
    k: VariableBuilder(
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/variables/builder.py", line 172, in __call__
    return self._wrap(value).clone(**self.options())
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/variables/builder.py", line 238, in _wrap
    return self.wrap_tensor(value)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/variables/builder.py", line 639, in wrap_tensor
    tensor_variable = wrap_fx_proxy(
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/variables/builder.py", line 754, in wrap_fx_proxy
    return wrap_fx_proxy_cls(
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/variables/builder.py", line 814, in wrap_fx_proxy_cls
    example_value = wrap_to_fake_tensor_and_record(
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/contextlib.py", line 124, in __exit__
    next(self.gen)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/utils.py", line 551, in preserve_rng_state
    torch.cuda.set_rng_state(cuda_rng)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/cuda/random.py", line 64, in set_rng_state
    _lazy_call(cb)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/cuda/__init__.py", line 183, in _lazy_call
    callable()
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/cuda/random.py", line 62, in cb
    default_generator.set_state(new_state_copy)
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


Set torch._dynamo.config.verbose=True for more information


You can suppress this exception and fall back to eager by setting:
    torch._dynamo.config.suppress_errors = True


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 104, in _fn
    return fn(*args, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 262, in _convert_frame_assert
    return _compile(
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/utils.py", line 163, in time_wrapper
    r = func(*args, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 394, in _compile
    raise InternalTorchDynamoError() from e
torch._dynamo.exc.InternalTorchDynamoError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/engine/train_loop.py", line 151, in train
    self.run_step()
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/engine/defaults.py", line 441, in run_step
    logits = self.model(data)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/eval_frame.py", line 82, in forward
    return self.dynamo_ctx(self._orig_mod.forward)(*args, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/eval_frame.py", line 209, in _fn
    return fn(*args, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/eval_frame.py", line 334, in catch_errors
    return hijacked_callback(frame, cache_size, hooks)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 404, in _convert_frame
    result = inner_convert(frame, cache_size, hooks)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 109, in _fn
    torch.cuda.set_rng_state(cuda_rng_state)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/cuda/random.py", line 64, in set_rng_state
    _lazy_call(cb)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/cuda/__init__.py", line 183, in _lazy_call
    callable()
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/cuda/random.py", line 62, in cb
    default_generator.set_state(new_state_copy)
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[07/04 13:52:36] pts.engine.hooks INFO: Total training time: 0:00:35 (0:00:00 on hooks)
[07/04 13:52:36] pts.engine.hooks INFO: Best accuracy 0.000%
[07/04 13:52:36] pts.utils.events INFO:  iter: 0 -- [0/259]    lr: N/A  max_mem: 3255M
[07/04 18:12:25] pytorchvideo INFO: Rank of current process: 0. World size: 4
[07/04 18:12:25] pytorchvideo INFO: Environment info:
----------------------  ---------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.0 (default, Nov 15 2020, 14:28:56) [GCC 7.3.0]
numpy                   1.24.2
PyTorch                 2.0.0+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 3090 (arch=8.6)
CUDA_HOME               /usr
Pillow                  10.0.1
torchvision             0.15.1+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.10
----------------------  ---------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[07/04 18:12:26] pytorchvideo INFO: Command line arguments: Namespace(config_file='experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml', resume=False, eval_only=False, num_gpus=4, repeat_time=1, num_machines=1, machine_rank=0, dist_url='auto', opts=[])
[07/04 18:12:26] pytorchvideo INFO: Contents of args.config_file=experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml:
DATASET:
  NAME: 'VideoClsDataset'

DATALOADER:
  TRAIN_BATCH_SIZE: 8
  TEST_BATCH_SIZE: 8
  TOTAL_BATCH_SIZE: 32
  NUM_WORKERS: 4
  ROOT_PATH: '/data/tanyi/EGTEA_Gaze+'
  TRAIN_LIST_FILE: 'trainValTest/train1.txt'
  TEST_LIST_FILE: 'trainValTest/val1.txt'
  FORMAT: 'DECORD_.mp4'
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  CLIP_LENGTH: 1
  NUM_STEPS: 1

ENGINE:
  NAME: 'DefaultTrainer'
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True

TRANSFORM:
  NAME: 'SIFARTransform'
  CROP_SIZE: 224
  TEST_CROP_SIZE: 224
  NO_HORIZONTAL_FLIP: False
  TIME_DIM: 'T'
  MIXUP_PROB: 1.
  SWITCH_PROB: .5
  MASK_MOTION_CUT: 1.
  MIXUP_LABELSMOOTHING: .1


MODEL:
  NAME: 'VIDEO_SWIN'
  ARCH: 'video_swin_vit_s_p4_w7'
  NUM_CLASSES: 48
  DROP_PATH_RATIO: 0.2
  WEIGHTS: '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
  REMOVE_FC: True
  FROZEN_BN: False
  TRANSFER_WEIGHTS: True

SOLVER:
  NAME: 'AdamW'
  NAME_MIXBLOCK: 'SGD'
  PARAMS: 'default'
  EPOCH: 50
  CHECKPOINT_PERIOD: 1
  EVAL_PERIOD: 5
  DENSE_EVAL_EPOCH: 40
  BASE_LR: 2e-4
  BASE_LR_MIXBLOCK: 0.02
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  MOMENTUM: 0.9
  ALPHA: 0.99
  BETAS: [0.9, 0.999]
  WRITE_PERIOD: 50
  AUTO_LR: False
  GRAD_CLIP: 1.
  GRAD_CLIP_MIXBLOCK: 20.

LR_SCHEDULER:
  NAME: 'WarmupCosineLR'
  WARMUP_EPOCH: 5

LOSSES:
  # NAMES: ['LabelSmoothing']
  # LABELSMOOTHING: 0.1
  NAMES: ['SoftTargetCrossEntropy']


INFERENCE:
  NAME: 'ClsEvaluator'
[07/04 18:12:26] pytorchvideo INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  CLIP_LENGTH: 1
  FORMAT: DECORD_.mp4
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  NUM_STEPS: 1
  NUM_WORKERS: 4
  ROOT_PATH: /data/tanyi/EGTEA_Gaze+
  SHUFFLE: True
  TEST_BATCH_SIZE: 8
  TEST_LIST_FILE: trainValTest/val1.txt
  TOTAL_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
  TRAIN_LIST_FILE: trainValTest/train1.txt
DATASET:
  NAME: VideoClsDataset
ENGINE:
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True
  NAME: DefaultTrainer
INFERENCE:
  NAME: ClsEvaluator
LOSSES:
  LABELSMOOTHING: 0.2
  NAMES: ['SoftTargetCrossEntropy']
  WEIGHTS: [1.0]
LR_SCHEDULER:
  GAMMA: 0.1
  MILESTONES: (3,)
  NAME: WarmupCosineLR
  STEP_SIZE: 3
  WARMUP_EPOCH: 5
MODEL:
  ARCH: video_swin_vit_s_p4_w7
  ARCH_CFGS: []
  DEVICE: cuda
  DROPOUT_RATIO: 0.0
  DROP_PATH_RATIO: 0.2
  EARLY_STRIDE: 1
  FROZEN_BN: False
  NAME: VIDEO_SWIN
  NUM_CLASSES: 48
  REMOVE_FC: True
  TRANSFER_WEIGHTS: True
  WEIGHTS: /data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth
OUTPUT_DIR: experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002
SEED: -1
SOLVER:
  ALPHA: 0.99
  AUTO_LR: False
  BASE_LR: 0.0002
  BASE_LR_MIXBLOCK: 0.02
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DENSE_EVAL_EPOCH: 40
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 5
  FC_LR5: False
  GRAD_CLIP: 1.0
  GRAD_CLIP_MIXBLOCK: 20.0
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.9
  NAME: AdamW
  NAME_MIXBLOCK: SGD
  NESTEROV: False
  NORM_TYPE: 2.0
  PARAMS: default
  REGULARIZE: 1.0
  SNAPSHOT: 
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  WEIGHT_DECAY_NORM: 0.0
  WRITE_PERIOD: 50
TRANSFORM:
  AUTO_AUG: rand-m7-n4-mstd0.5-inc1
  CROP_SIZE: 224
  MASK_MIX: 0.0
  MASK_MOTION_CUT: 1.0
  MASK_MOTION_CUT_STATIC: 0.0
  MIXUP_LABELSMOOTHING: 0.1
  MIXUP_PROB: 1.0
  MOTION_CUT: 0.0
  MOTION_CUT_STATIC: 0.0
  NAME: SIFARTransform
  NO_HORIZONTAL_FLIP: False
  SALIENCY_CUT: 0.0
  SWITCH_PROB: 0.5
  TEST_CROP_SIZE: 224
  TIME_DIM: T
  USE_FLOW: False
VERSION: 1
[07/04 18:12:26] pytorchvideo INFO: Full config saved to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/config.yaml
[07/04 18:12:26] pts.utils.env INFO: Using a generated random seed 28503487
[07/04 18:12:42] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 18:12:42] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 18:12:42] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 18:12:58] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 18:12:58] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 18:12:58] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 18:12:59] pts.engine.defaults INFO: Model:
VIDEO_SWIN(
  (patch_embed): PatchEmbed3D(
    (proj): Conv3d(3, 96, kernel_size=(2, 4, 4), stride=(2, 4, 4))
    (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (layers): ModuleList(
    (0): BasicLayer(
      (blocks): ModuleList(
        (0): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=384, out_features=192, bias=False)
        (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
    (1): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=192, out_features=576, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=192, out_features=192, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=768, out_features=192, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=768, out_features=384, bias=False)
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      )
    )
    (2): BasicLayer(
      (blocks): ModuleList(
        (0-17): 18 x SwinTransformerBlock3D(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=384, out_features=384, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1536, out_features=384, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=1536, out_features=768, bias=False)
        (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
      )
    )
    (3): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  (avgpool): AdaptiveAvgPool3d(output_size=1)
  (fc): Linear(in_features=768, out_features=48, bias=True)
)
[07/04 18:13:07] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/04 18:13:07] pts.engine.train_loop INFO: Starting training from iteration 0
[07/04 18:14:20] pytorchvideo INFO: Rank of current process: 0. World size: 4
[07/04 18:14:20] pytorchvideo INFO: Environment info:
----------------------  ---------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.0 (default, Nov 15 2020, 14:28:56) [GCC 7.3.0]
numpy                   1.24.2
PyTorch                 2.0.0+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 3090 (arch=8.6)
CUDA_HOME               /usr
Pillow                  10.0.1
torchvision             0.15.1+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.10
----------------------  ---------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[07/04 18:14:20] pytorchvideo INFO: Command line arguments: Namespace(config_file='experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml', resume=False, eval_only=False, num_gpus=4, repeat_time=1, num_machines=1, machine_rank=0, dist_url='auto', opts=[])
[07/04 18:14:20] pytorchvideo INFO: Contents of args.config_file=experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml:
DATASET:
  NAME: 'VideoClsDataset'

DATALOADER:
  TRAIN_BATCH_SIZE: 8
  TEST_BATCH_SIZE: 8
  TOTAL_BATCH_SIZE: 32
  NUM_WORKERS: 4
  ROOT_PATH: '/data/tanyi/EGTEA_Gaze+'
  TRAIN_LIST_FILE: 'trainValTest/train1.txt'
  TEST_LIST_FILE: 'trainValTest/val1.txt'
  FORMAT: 'DECORD_.mp4'
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  CLIP_LENGTH: 1
  NUM_STEPS: 1

ENGINE:
  NAME: 'DefaultTrainer'
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True

TRANSFORM:
  NAME: 'SIFARTransform'
  CROP_SIZE: 224
  TEST_CROP_SIZE: 224
  NO_HORIZONTAL_FLIP: False
  TIME_DIM: 'T'
  MIXUP_PROB: 1.
  SWITCH_PROB: .5
  MASK_MOTION_CUT: 1.
  MIXUP_LABELSMOOTHING: .1


MODEL:
  NAME: 'VIDEO_SWIN'
  ARCH: 'video_swin_vit_s_p4_w7'
  NUM_CLASSES: 48
  DROP_PATH_RATIO: 0.2
  WEIGHTS: '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
  REMOVE_FC: True
  FROZEN_BN: False
  TRANSFER_WEIGHTS: True

SOLVER:
  NAME: 'AdamW'
  NAME_MIXBLOCK: 'SGD'
  PARAMS: 'default'
  EPOCH: 50
  CHECKPOINT_PERIOD: 1
  EVAL_PERIOD: 5
  DENSE_EVAL_EPOCH: 40
  BASE_LR: 2e-4
  BASE_LR_MIXBLOCK: 0.02
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  MOMENTUM: 0.9
  ALPHA: 0.99
  BETAS: [0.9, 0.999]
  WRITE_PERIOD: 50
  AUTO_LR: False
  GRAD_CLIP: 1.
  GRAD_CLIP_MIXBLOCK: 20.

LR_SCHEDULER:
  NAME: 'WarmupCosineLR'
  WARMUP_EPOCH: 5

LOSSES:
  # NAMES: ['LabelSmoothing']
  # LABELSMOOTHING: 0.1
  NAMES: ['SoftTargetCrossEntropy']


INFERENCE:
  NAME: 'ClsEvaluator'
[07/04 18:14:20] pytorchvideo INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  CLIP_LENGTH: 1
  FORMAT: DECORD_.mp4
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  NUM_STEPS: 1
  NUM_WORKERS: 4
  ROOT_PATH: /data/tanyi/EGTEA_Gaze+
  SHUFFLE: True
  TEST_BATCH_SIZE: 8
  TEST_LIST_FILE: trainValTest/val1.txt
  TOTAL_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
  TRAIN_LIST_FILE: trainValTest/train1.txt
DATASET:
  NAME: VideoClsDataset
ENGINE:
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True
  NAME: DefaultTrainer
INFERENCE:
  NAME: ClsEvaluator
LOSSES:
  LABELSMOOTHING: 0.2
  NAMES: ['SoftTargetCrossEntropy']
  WEIGHTS: [1.0]
LR_SCHEDULER:
  GAMMA: 0.1
  MILESTONES: (3,)
  NAME: WarmupCosineLR
  STEP_SIZE: 3
  WARMUP_EPOCH: 5
MODEL:
  ARCH: video_swin_vit_s_p4_w7
  ARCH_CFGS: []
  DEVICE: cuda
  DROPOUT_RATIO: 0.0
  DROP_PATH_RATIO: 0.2
  EARLY_STRIDE: 1
  FROZEN_BN: False
  NAME: VIDEO_SWIN
  NUM_CLASSES: 48
  REMOVE_FC: True
  TRANSFER_WEIGHTS: True
  WEIGHTS: /data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth
OUTPUT_DIR: experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002
SEED: -1
SOLVER:
  ALPHA: 0.99
  AUTO_LR: False
  BASE_LR: 0.0002
  BASE_LR_MIXBLOCK: 0.02
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DENSE_EVAL_EPOCH: 40
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 5
  FC_LR5: False
  GRAD_CLIP: 1.0
  GRAD_CLIP_MIXBLOCK: 20.0
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.9
  NAME: AdamW
  NAME_MIXBLOCK: SGD
  NESTEROV: False
  NORM_TYPE: 2.0
  PARAMS: default
  REGULARIZE: 1.0
  SNAPSHOT: 
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  WEIGHT_DECAY_NORM: 0.0
  WRITE_PERIOD: 50
TRANSFORM:
  AUTO_AUG: rand-m7-n4-mstd0.5-inc1
  CROP_SIZE: 224
  MASK_MIX: 0.0
  MASK_MOTION_CUT: 1.0
  MASK_MOTION_CUT_STATIC: 0.0
  MIXUP_LABELSMOOTHING: 0.1
  MIXUP_PROB: 1.0
  MOTION_CUT: 0.0
  MOTION_CUT_STATIC: 0.0
  NAME: SIFARTransform
  NO_HORIZONTAL_FLIP: False
  SALIENCY_CUT: 0.0
  SWITCH_PROB: 0.5
  TEST_CROP_SIZE: 224
  TIME_DIM: T
  USE_FLOW: False
VERSION: 1
[07/04 18:14:20] pytorchvideo INFO: Full config saved to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/config.yaml
[07/04 18:14:20] pts.utils.env INFO: Using a generated random seed 23349942
[07/04 18:14:36] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 18:14:36] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 18:14:36] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 18:14:52] pytorchvideo INFO: Rank of current process: 0. World size: 4
[07/04 18:14:52] pytorchvideo INFO: Environment info:
----------------------  ---------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.0 (default, Nov 15 2020, 14:28:56) [GCC 7.3.0]
numpy                   1.24.2
PyTorch                 2.0.0+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 3090 (arch=8.6)
CUDA_HOME               /usr
Pillow                  10.0.1
torchvision             0.15.1+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.10
----------------------  ---------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[07/04 18:14:52] pytorchvideo INFO: Command line arguments: Namespace(config_file='experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml', resume=False, eval_only=False, num_gpus=4, repeat_time=1, num_machines=1, machine_rank=0, dist_url='auto', opts=[])
[07/04 18:14:52] pytorchvideo INFO: Contents of args.config_file=experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml:
DATASET:
  NAME: 'VideoClsDataset'

DATALOADER:
  TRAIN_BATCH_SIZE: 8
  TEST_BATCH_SIZE: 8
  TOTAL_BATCH_SIZE: 32
  NUM_WORKERS: 4
  ROOT_PATH: '/data/tanyi/EGTEA_Gaze+'
  TRAIN_LIST_FILE: 'trainValTest/train1.txt'
  TEST_LIST_FILE: 'trainValTest/val1.txt'
  FORMAT: 'DECORD_.mp4'
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  CLIP_LENGTH: 1
  NUM_STEPS: 1

ENGINE:
  NAME: 'DefaultTrainer'
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True

TRANSFORM:
  NAME: 'SIFARTransform'
  CROP_SIZE: 224
  TEST_CROP_SIZE: 224
  NO_HORIZONTAL_FLIP: False
  TIME_DIM: 'T'
  MIXUP_PROB: 1.
  SWITCH_PROB: .5
  MASK_MOTION_CUT: 1.
  MIXUP_LABELSMOOTHING: .1


MODEL:
  NAME: 'VIDEO_SWIN'
  ARCH: 'video_swin_vit_s_p4_w7'
  NUM_CLASSES: 48
  DROP_PATH_RATIO: 0.2
  WEIGHTS: '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
  REMOVE_FC: True
  FROZEN_BN: False
  TRANSFER_WEIGHTS: True

SOLVER:
  NAME: 'AdamW'
  NAME_MIXBLOCK: 'SGD'
  PARAMS: 'default'
  EPOCH: 50
  CHECKPOINT_PERIOD: 1
  EVAL_PERIOD: 5
  DENSE_EVAL_EPOCH: 40
  BASE_LR: 2e-4
  BASE_LR_MIXBLOCK: 0.02
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  MOMENTUM: 0.9
  ALPHA: 0.99
  BETAS: [0.9, 0.999]
  WRITE_PERIOD: 50
  AUTO_LR: False
  GRAD_CLIP: 1.
  GRAD_CLIP_MIXBLOCK: 20.

LR_SCHEDULER:
  NAME: 'WarmupCosineLR'
  WARMUP_EPOCH: 5

LOSSES:
  # NAMES: ['LabelSmoothing']
  # LABELSMOOTHING: 0.1
  NAMES: ['SoftTargetCrossEntropy']


INFERENCE:
  NAME: 'ClsEvaluator'
[07/04 18:14:52] pytorchvideo INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  CLIP_LENGTH: 1
  FORMAT: DECORD_.mp4
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  NUM_STEPS: 1
  NUM_WORKERS: 4
  ROOT_PATH: /data/tanyi/EGTEA_Gaze+
  SHUFFLE: True
  TEST_BATCH_SIZE: 8
  TEST_LIST_FILE: trainValTest/val1.txt
  TOTAL_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
  TRAIN_LIST_FILE: trainValTest/train1.txt
DATASET:
  NAME: VideoClsDataset
ENGINE:
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True
  NAME: DefaultTrainer
INFERENCE:
  NAME: ClsEvaluator
LOSSES:
  LABELSMOOTHING: 0.2
  NAMES: ['SoftTargetCrossEntropy']
  WEIGHTS: [1.0]
LR_SCHEDULER:
  GAMMA: 0.1
  MILESTONES: (3,)
  NAME: WarmupCosineLR
  STEP_SIZE: 3
  WARMUP_EPOCH: 5
MODEL:
  ARCH: video_swin_vit_s_p4_w7
  ARCH_CFGS: []
  DEVICE: cuda
  DROPOUT_RATIO: 0.0
  DROP_PATH_RATIO: 0.2
  EARLY_STRIDE: 1
  FROZEN_BN: False
  NAME: VIDEO_SWIN
  NUM_CLASSES: 48
  REMOVE_FC: True
  TRANSFER_WEIGHTS: True
  WEIGHTS: /data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth
OUTPUT_DIR: experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002
SEED: -1
SOLVER:
  ALPHA: 0.99
  AUTO_LR: False
  BASE_LR: 0.0002
  BASE_LR_MIXBLOCK: 0.02
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DENSE_EVAL_EPOCH: 40
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 5
  FC_LR5: False
  GRAD_CLIP: 1.0
  GRAD_CLIP_MIXBLOCK: 20.0
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.9
  NAME: AdamW
  NAME_MIXBLOCK: SGD
  NESTEROV: False
  NORM_TYPE: 2.0
  PARAMS: default
  REGULARIZE: 1.0
  SNAPSHOT: 
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  WEIGHT_DECAY_NORM: 0.0
  WRITE_PERIOD: 50
TRANSFORM:
  AUTO_AUG: rand-m7-n4-mstd0.5-inc1
  CROP_SIZE: 224
  MASK_MIX: 0.0
  MASK_MOTION_CUT: 1.0
  MASK_MOTION_CUT_STATIC: 0.0
  MIXUP_LABELSMOOTHING: 0.1
  MIXUP_PROB: 1.0
  MOTION_CUT: 0.0
  MOTION_CUT_STATIC: 0.0
  NAME: SIFARTransform
  NO_HORIZONTAL_FLIP: False
  SALIENCY_CUT: 0.0
  SWITCH_PROB: 0.5
  TEST_CROP_SIZE: 224
  TIME_DIM: T
  USE_FLOW: False
VERSION: 1
[07/04 18:14:52] pytorchvideo INFO: Full config saved to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/config.yaml
[07/04 18:14:52] pts.utils.env INFO: Using a generated random seed 55100209
[07/04 18:15:04] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 18:15:04] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 18:15:04] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 18:15:24] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 18:15:24] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 18:15:24] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 18:15:25] pts.engine.defaults INFO: Model:
VIDEO_SWIN(
  (patch_embed): PatchEmbed3D(
    (proj): Conv3d(3, 96, kernel_size=(2, 4, 4), stride=(2, 4, 4))
    (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (layers): ModuleList(
    (0): BasicLayer(
      (blocks): ModuleList(
        (0): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=384, out_features=192, bias=False)
        (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
    (1): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=192, out_features=576, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=192, out_features=192, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=768, out_features=192, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=768, out_features=384, bias=False)
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      )
    )
    (2): BasicLayer(
      (blocks): ModuleList(
        (0-17): 18 x SwinTransformerBlock3D(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=384, out_features=384, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1536, out_features=384, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=1536, out_features=768, bias=False)
        (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
      )
    )
    (3): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  (avgpool): AdaptiveAvgPool3d(output_size=1)
  (fc): Linear(in_features=768, out_features=48, bias=True)
)
[07/04 18:15:33] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/04 18:15:33] pts.engine.train_loop INFO: Starting training from iteration 0
[07/04 18:16:10] pts.engine.train_loop ERROR: Exception during training:
Traceback (most recent call last):
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/engine/train_loop.py", line 151, in train
    self.run_step()
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/engine/defaults.py", line 441, in run_step
    logits = self.model(data)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/model/video_swin.py", line 184, in forward
    x, feature_map7x7 = self.forward_features(x, featuremap)
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/model/swin3d_vit.py", line 674, in forward_features
    x = self.patch_embed(x)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/tanyi/ICCV23_learning_mask_tip_addEXP/pytorchvideo/model/swin3d_vit.py", line 452, in forward
    x = self.proj(x)  # B C D Wh Ww
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 613, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 608, in _conv_forward
    return F.conv3d(
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[07/04 18:16:10] pts.engine.hooks INFO: Total training time: 0:00:36 (0:00:00 on hooks)
[07/04 18:16:10] pts.engine.hooks INFO: Best accuracy 0.000%
[07/04 18:16:10] pts.utils.events INFO:  iter: 0 -- [0/259]    lr: N/A  max_mem: 3255M
[07/04 18:16:50] pytorchvideo INFO: Rank of current process: 0. World size: 4
[07/04 18:16:51] pytorchvideo INFO: Environment info:
----------------------  ---------------------------------------------------------------------------------------
sys.platform            linux
Python                  3.9.0 (default, Nov 15 2020, 14:28:56) [GCC 7.3.0]
numpy                   1.24.2
PyTorch                 2.0.0+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torch
PyTorch debug build     False
GPU available           True
GPU 0,1,2,3             NVIDIA GeForce RTX 3090 (arch=8.6)
CUDA_HOME               /usr
Pillow                  10.0.1
torchvision             0.15.1+cu117 @/data/tanyi/anaconda3/envs/torch2/lib/python3.9/site-packages/torchvision
torchvision arch flags  3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                  0.1.5.post20221221
iopath                  0.1.10
----------------------  ---------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.7.3 (Git Hash 6dbeffbae1f23cbbeae17adb7b5b13f1f37c080e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.0.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[07/04 18:16:51] pytorchvideo INFO: Command line arguments: Namespace(config_file='experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml', resume=False, eval_only=False, num_gpus=4, repeat_time=1, num_machines=1, machine_rank=0, dist_url='auto', opts=[])
[07/04 18:16:51] pytorchvideo INFO: Contents of args.config_file=experiments/eg_swin_s2s+t2t_8gpu_mixlr002.yaml:
DATASET:
  NAME: 'VideoClsDataset'

DATALOADER:
  TRAIN_BATCH_SIZE: 8
  TEST_BATCH_SIZE: 8
  TOTAL_BATCH_SIZE: 32
  NUM_WORKERS: 4
  ROOT_PATH: '/data/tanyi/EGTEA_Gaze+'
  TRAIN_LIST_FILE: 'trainValTest/train1.txt'
  TEST_LIST_FILE: 'trainValTest/val1.txt'
  FORMAT: 'DECORD_.mp4'
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  CLIP_LENGTH: 1
  NUM_STEPS: 1

ENGINE:
  NAME: 'DefaultTrainer'
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True

TRANSFORM:
  NAME: 'SIFARTransform'
  CROP_SIZE: 224
  TEST_CROP_SIZE: 224
  NO_HORIZONTAL_FLIP: False
  TIME_DIM: 'T'
  MIXUP_PROB: 1.
  SWITCH_PROB: .5
  MASK_MOTION_CUT: 1.
  MIXUP_LABELSMOOTHING: .1


MODEL:
  NAME: 'VIDEO_SWIN'
  ARCH: 'video_swin_vit_s_p4_w7'
  NUM_CLASSES: 106
  DROP_PATH_RATIO: 0.2
  WEIGHTS: '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
  REMOVE_FC: True
  FROZEN_BN: False
  TRANSFER_WEIGHTS: True

SOLVER:
  NAME: 'AdamW'
  NAME_MIXBLOCK: 'SGD'
  PARAMS: 'default'
  EPOCH: 50
  CHECKPOINT_PERIOD: 1
  EVAL_PERIOD: 5
  DENSE_EVAL_EPOCH: 40
  BASE_LR: 2e-4
  BASE_LR_MIXBLOCK: 0.02
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  MOMENTUM: 0.9
  ALPHA: 0.99
  BETAS: [0.9, 0.999]
  WRITE_PERIOD: 50
  AUTO_LR: False
  GRAD_CLIP: 1.
  GRAD_CLIP_MIXBLOCK: 20.

LR_SCHEDULER:
  NAME: 'WarmupCosineLR'
  WARMUP_EPOCH: 5

LOSSES:
  # NAMES: ['LabelSmoothing']
  # LABELSMOOTHING: 0.1
  NAMES: ['SoftTargetCrossEntropy']


INFERENCE:
  NAME: 'ClsEvaluator'
[07/04 18:16:51] pytorchvideo INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  CLIP_LENGTH: 1
  FORMAT: DECORD_.mp4
  NUM_CLIPS: 1
  NUM_CROPS: 1
  NUM_SEGMENTS: 16
  NUM_STEPS: 1
  NUM_WORKERS: 4
  ROOT_PATH: /data/tanyi/EGTEA_Gaze+
  SHUFFLE: True
  TEST_BATCH_SIZE: 8
  TEST_LIST_FILE: trainValTest/val1.txt
  TOTAL_BATCH_SIZE: 32
  TRAIN_BATCH_SIZE: 8
  TRAIN_LIST_FILE: trainValTest/train1.txt
DATASET:
  NAME: VideoClsDataset
ENGINE:
  BEST_METRICS: ['ACC-1crop@1']
  FP16: True
  NAME: DefaultTrainer
INFERENCE:
  NAME: ClsEvaluator
LOSSES:
  LABELSMOOTHING: 0.2
  NAMES: ['SoftTargetCrossEntropy']
  WEIGHTS: [1.0]
LR_SCHEDULER:
  GAMMA: 0.1
  MILESTONES: (3,)
  NAME: WarmupCosineLR
  STEP_SIZE: 3
  WARMUP_EPOCH: 5
MODEL:
  ARCH: video_swin_vit_s_p4_w7
  ARCH_CFGS: []
  DEVICE: cuda
  DROPOUT_RATIO: 0.0
  DROP_PATH_RATIO: 0.2
  EARLY_STRIDE: 1
  FROZEN_BN: False
  NAME: VIDEO_SWIN
  NUM_CLASSES: 106
  REMOVE_FC: True
  TRANSFER_WEIGHTS: True
  WEIGHTS: /data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth
OUTPUT_DIR: experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002
SEED: -1
SOLVER:
  ALPHA: 0.99
  AUTO_LR: False
  BASE_LR: 0.0002
  BASE_LR_MIXBLOCK: 0.02
  BETAS: [0.9, 0.999]
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  DENSE_EVAL_EPOCH: 40
  EPOCH: 50
  EPS: 1e-08
  EVAL_PERIOD: 5
  FC_LR5: False
  GRAD_CLIP: 1.0
  GRAD_CLIP_MIXBLOCK: 20.0
  GRAD_CLIP_TYPE: norm
  MOMENTUM: 0.9
  NAME: AdamW
  NAME_MIXBLOCK: SGD
  NESTEROV: False
  NORM_TYPE: 2.0
  PARAMS: default
  REGULARIZE: 1.0
  SNAPSHOT: 
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_BIAS: 0.0
  WEIGHT_DECAY_MIXBLOCK: 0.0001
  WEIGHT_DECAY_NORM: 0.0
  WRITE_PERIOD: 50
TRANSFORM:
  AUTO_AUG: rand-m7-n4-mstd0.5-inc1
  CROP_SIZE: 224
  MASK_MIX: 0.0
  MASK_MOTION_CUT: 1.0
  MASK_MOTION_CUT_STATIC: 0.0
  MIXUP_LABELSMOOTHING: 0.1
  MIXUP_PROB: 1.0
  MOTION_CUT: 0.0
  MOTION_CUT_STATIC: 0.0
  NAME: SIFARTransform
  NO_HORIZONTAL_FLIP: False
  SALIENCY_CUT: 0.0
  SWITCH_PROB: 0.5
  TEST_CROP_SIZE: 224
  TIME_DIM: T
  USE_FLOW: False
VERSION: 1
[07/04 18:16:51] pytorchvideo INFO: Full config saved to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/config.yaml
[07/04 18:16:51] pts.utils.env INFO: Using a generated random seed 53991042
[07/04 18:17:07] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 18:17:07] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 18:17:07] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 18:17:24] pts.model.base_net INFO: Missing keys: ['layers.0.blocks.0.attn.relative_position_index', 'layers.0.blocks.1.attn.relative_position_index', 'layers.1.blocks.0.attn.relative_position_index', 'layers.1.blocks.1.attn.relative_position_index', 'layers.2.blocks.0.attn.relative_position_index', 'layers.2.blocks.1.attn.relative_position_index', 'layers.2.blocks.2.attn.relative_position_index', 'layers.2.blocks.3.attn.relative_position_index', 'layers.2.blocks.4.attn.relative_position_index', 'layers.2.blocks.5.attn.relative_position_index', 'layers.2.blocks.6.attn.relative_position_index', 'layers.2.blocks.7.attn.relative_position_index', 'layers.2.blocks.8.attn.relative_position_index', 'layers.2.blocks.9.attn.relative_position_index', 'layers.2.blocks.10.attn.relative_position_index', 'layers.2.blocks.11.attn.relative_position_index', 'layers.2.blocks.12.attn.relative_position_index', 'layers.2.blocks.13.attn.relative_position_index', 'layers.2.blocks.14.attn.relative_position_index', 'layers.2.blocks.15.attn.relative_position_index', 'layers.2.blocks.16.attn.relative_position_index', 'layers.2.blocks.17.attn.relative_position_index', 'layers.3.blocks.0.attn.relative_position_index', 'layers.3.blocks.1.attn.relative_position_index', 'fc.weight', 'fc.bias']
[07/04 18:17:24] pts.model.base_net INFO: Unexpect keys: ['cls_head.fc_cls.weight', 'cls_head.fc_cls.bias']
[07/04 18:17:24] pts.model.base_net INFO: ==> loaded checkpoint '/data/tanyi/swin_small_patch244_window877_kinetics400_1k.pth'
[07/04 18:17:25] pts.engine.defaults INFO: Model:
VIDEO_SWIN(
  (patch_embed): PatchEmbed3D(
    (proj): Conv3d(3, 96, kernel_size=(2, 4, 4), stride=(2, 4, 4))
    (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (layers): ModuleList(
    (0): BasicLayer(
      (blocks): ModuleList(
        (0): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (1): SwinTransformerBlock3D(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=384, out_features=192, bias=False)
        (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
    (1): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=192, out_features=576, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=192, out_features=192, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=768, out_features=192, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=768, out_features=384, bias=False)
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      )
    )
    (2): BasicLayer(
      (blocks): ModuleList(
        (0-17): 18 x SwinTransformerBlock3D(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=384, out_features=384, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1536, out_features=384, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=1536, out_features=768, bias=False)
        (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
      )
    )
    (3): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock3D(
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention3D(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  (avgpool): AdaptiveAvgPool3d(output_size=1)
  (fc): Linear(in_features=768, out_features=106, bias=True)
)
[07/04 18:17:33] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[07/04 18:17:33] pts.engine.train_loop INFO: Starting training from iteration 0
[07/04 18:20:18] pts.utils.events INFO:  eta: 2:02:10  iter: 49 -- [49/259]  total_loss: 9.28  soft_target_cross_entropy_loss: 4.609  loss_ofl: 4.663  mask_loss: 0.0001157  time: 0.7139  data_time: 0.2256  lr: 9.4919e-06  max_mem: 21178M
[07/04 18:20:54] pts.utils.events INFO:  eta: 2:02:18  iter: 99 -- [99/259]  total_loss: 9.036  soft_target_cross_entropy_loss: 4.359  loss_ofl: 4.655  mask_loss: 0  time: 0.7041  data_time: 0.1942  lr: 1.7137e-05  max_mem: 21178M
[07/04 18:21:30] pts.utils.events INFO:  eta: 2:02:20  iter: 149 -- [149/259]  total_loss: 8.771  soft_target_cross_entropy_loss: 4.165  loss_ofl: 4.635  mask_loss: 0  time: 0.7071  data_time: 0.1227  lr: 2.4781e-05  max_mem: 21178M
[07/04 18:22:04] pts.utils.events INFO:  eta: 2:02:20  iter: 199 -- [199/259]  total_loss: 8.71  soft_target_cross_entropy_loss: 4.068  loss_ofl: 4.658  mask_loss: 0  time: 0.6989  data_time: 0.0002  lr: 3.2426e-05  max_mem: 21178M
[07/04 18:22:39] pts.utils.events INFO:  eta: 2:02:31  iter: 249 -- [249/259]  total_loss: 8.551  soft_target_cross_entropy_loss: 3.92  loss_ofl: 4.634  mask_loss: 0  time: 0.6955  data_time: 0.1170  lr: 4.0071e-05  max_mem: 21178M
[07/04 18:22:47] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 18:23:31] pts.utils.events INFO:  eta: 2:02:02  iter: 299 -- [40/259]  total_loss: 8.327  soft_target_cross_entropy_loss: 3.699  loss_ofl: 4.628  mask_loss: 0  time: 0.7468  data_time: 0.1241  lr: 4.7716e-05  max_mem: 21178M
[07/04 18:24:06] pts.utils.events INFO:  eta: 2:01:50  iter: 349 -- [90/259]  total_loss: 8.076  soft_target_cross_entropy_loss: 3.481  loss_ofl: 4.617  mask_loss: 5.89e-05  time: 0.7393  data_time: 0.0604  lr: 5.5361e-05  max_mem: 21178M
[07/04 18:24:48] pts.utils.events INFO:  eta: 2:01:34  iter: 399 -- [140/259]  total_loss: 8.045  soft_target_cross_entropy_loss: 3.435  loss_ofl: 4.607  mask_loss: 3.593e-05  time: 0.7497  data_time: 0.2726  lr: 6.3005e-05  max_mem: 21178M
[07/04 18:25:23] pts.utils.events INFO:  eta: 2:00:58  iter: 449 -- [190/259]  total_loss: 7.919  soft_target_cross_entropy_loss: 3.342  loss_ofl: 4.56  mask_loss: 0  time: 0.7437  data_time: 0.0409  lr: 7.065e-05  max_mem: 21178M
[07/04 18:26:02] pts.utils.events INFO:  eta: 2:00:37  iter: 499 -- [240/259]  total_loss: 7.727  soft_target_cross_entropy_loss: 3.192  loss_ofl: 4.526  mask_loss: 0  time: 0.7454  data_time: 0.1419  lr: 7.8295e-05  max_mem: 21178M
[07/04 18:26:14] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 18:26:53] pts.utils.events INFO:  eta: 2:00:05  iter: 549 -- [31/259]  total_loss: 7.516  soft_target_cross_entropy_loss: 3.057  loss_ofl: 4.479  mask_loss: 0  time: 0.7664  data_time: 0.1677  lr: 8.594e-05  max_mem: 21178M
[07/04 18:27:31] pts.utils.events INFO:  eta: 1:59:27  iter: 599 -- [81/259]  total_loss: 7.45  soft_target_cross_entropy_loss: 3.016  loss_ofl: 4.448  mask_loss: 4.03e-06  time: 0.7638  data_time: 0.0867  lr: 9.3585e-05  max_mem: 21178M
[07/04 18:28:06] pts.utils.events INFO:  eta: 1:59:10  iter: 649 -- [131/259]  total_loss: 7.374  soft_target_cross_entropy_loss: 2.956  loss_ofl: 4.405  mask_loss: 0  time: 0.7592  data_time: 0.1347  lr: 0.00010123  max_mem: 21178M
[07/04 18:28:40] pts.utils.events INFO:  eta: 1:58:51  iter: 699 -- [181/259]  total_loss: 7.333  soft_target_cross_entropy_loss: 3.018  loss_ofl: 4.356  mask_loss: 3.563e-05  time: 0.7517  data_time: 0.0814  lr: 0.00010887  max_mem: 21178M
[07/04 18:29:15] pts.utils.events INFO:  eta: 1:58:31  iter: 749 -- [231/259]  total_loss: 7.11  soft_target_cross_entropy_loss: 2.895  loss_ofl: 4.283  mask_loss: 0  time: 0.7477  data_time: 0.0637  lr: 0.00011652  max_mem: 21178M
[07/04 18:29:34] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 18:30:06] pts.utils.events INFO:  eta: 1:58:05  iter: 799 -- [22/259]  total_loss: 7.019  soft_target_cross_entropy_loss: 2.842  loss_ofl: 4.182  mask_loss: 0  time: 0.7619  data_time: 0.0539  lr: 0.00012416  max_mem: 21179M
[07/04 18:30:42] pts.utils.events INFO:  eta: 1:57:32  iter: 849 -- [72/259]  total_loss: 7.079  soft_target_cross_entropy_loss: 2.929  loss_ofl: 4.14  mask_loss: 4.772e-05  time: 0.7582  data_time: 0.1726  lr: 0.00013181  max_mem: 21179M
[07/04 18:31:19] pts.utils.events INFO:  eta: 1:57:01  iter: 899 -- [122/259]  total_loss: 6.978  soft_target_cross_entropy_loss: 2.919  loss_ofl: 4.041  mask_loss: 0  time: 0.7566  data_time: 0.0904  lr: 0.00013945  max_mem: 21179M
[07/04 18:31:56] pts.utils.events INFO:  eta: 1:56:33  iter: 949 -- [172/259]  total_loss: 6.854  soft_target_cross_entropy_loss: 2.888  loss_ofl: 3.965  mask_loss: 0  time: 0.7549  data_time: 0.0883  lr: 0.0001471  max_mem: 21179M
[07/04 18:32:31] pts.utils.events INFO:  eta: 1:56:07  iter: 999 -- [222/259]  total_loss: 6.717  soft_target_cross_entropy_loss: 2.812  loss_ofl: 3.84  mask_loss: 5.244e-05  time: 0.7514  data_time: 0.0532  lr: 0.00015474  max_mem: 21179M
[07/04 18:32:57] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 18:33:22] pts.utils.events INFO:  eta: 1:55:43  iter: 1049 -- [13/259]  total_loss: 6.802  soft_target_cross_entropy_loss: 2.91  loss_ofl: 3.831  mask_loss: 0  time: 0.7620  data_time: 0.9074  lr: 0.00016239  max_mem: 21179M
[07/04 18:33:55] pts.utils.events INFO:  eta: 1:55:17  iter: 1099 -- [63/259]  total_loss: 6.102  soft_target_cross_entropy_loss: 2.594  loss_ofl: 3.647  mask_loss: 0  time: 0.7571  data_time: 0.0277  lr: 0.00017003  max_mem: 21179M
[07/04 18:34:32] pts.utils.events INFO:  eta: 1:54:55  iter: 1149 -- [113/259]  total_loss: 6.22  soft_target_cross_entropy_loss: 2.683  loss_ofl: 3.549  mask_loss: 0  time: 0.7558  data_time: 0.1271  lr: 0.00017768  max_mem: 21179M
[07/04 18:35:07] pts.utils.events INFO:  eta: 1:54:28  iter: 1199 -- [163/259]  total_loss: 6.335  soft_target_cross_entropy_loss: 2.827  loss_ofl: 3.52  mask_loss: 0  time: 0.7525  data_time: 0.0370  lr: 0.00018532  max_mem: 21179M
[07/04 18:35:39] pts.utils.events INFO:  eta: 1:53:57  iter: 1249 -- [213/259]  total_loss: 6.261  soft_target_cross_entropy_loss: 2.802  loss_ofl: 3.391  mask_loss: 0  time: 0.7479  data_time: 0.0822  lr: 0.00019297  max_mem: 21179M
[07/04 18:38:21] pts.engine.hooks INFO: ############################## Test: 5 ##############################
[07/04 18:38:21] pts.engine.hooks INFO: ACC-1crop@1: 0.5568743348121643
[07/04 18:38:21] pts.engine.hooks INFO: ACC-1crop@5: 0.8630068898200989
[07/04 18:38:21] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 18:38:23] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/best.pth
[07/04 18:38:41] pts.utils.events INFO:  eta: 1:53:28  iter: 1299 -- [4/259]  total_loss: 5.983  soft_target_cross_entropy_loss: 2.661  loss_ofl: 3.247  mask_loss: 0  time: 0.7593  data_time: 0.7578  lr: 0.0002  max_mem: 21179M
[07/04 18:39:13] pts.utils.events INFO:  eta: 1:52:51  iter: 1349 -- [54/259]  total_loss: 6.066  soft_target_cross_entropy_loss: 2.801  loss_ofl: 3.242  mask_loss: 0  time: 0.7541  data_time: 0.0363  lr: 0.00019999  max_mem: 21179M
[07/04 18:39:49] pts.utils.events INFO:  eta: 1:52:17  iter: 1399 -- [104/259]  total_loss: 5.657  soft_target_cross_entropy_loss: 2.606  loss_ofl: 3.101  mask_loss: 0  time: 0.7529  data_time: 0.1441  lr: 0.00019996  max_mem: 21179M
[07/04 18:40:25] pts.utils.events INFO:  eta: 1:51:48  iter: 1449 -- [154/259]  total_loss: 5.785  soft_target_cross_entropy_loss: 2.702  loss_ofl: 3.097  mask_loss: 0  time: 0.7512  data_time: 0.0807  lr: 0.00019992  max_mem: 21179M
[07/04 18:40:59] pts.utils.events INFO:  eta: 1:51:21  iter: 1499 -- [204/259]  total_loss: 5.721  soft_target_cross_entropy_loss: 2.685  loss_ofl: 3.009  mask_loss: 0  time: 0.7485  data_time: 0.0489  lr: 0.00019985  max_mem: 21179M
[07/04 18:41:34] pts.utils.events INFO:  eta: 1:50:54  iter: 1549 -- [254/259]  total_loss: 5.583  soft_target_cross_entropy_loss: 2.565  loss_ofl: 3.015  mask_loss: 0  time: 0.7462  data_time: 0.0640  lr: 0.00019977  max_mem: 21179M
[07/04 18:41:36] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 18:42:24] pts.utils.events INFO:  eta: 1:50:24  iter: 1599 -- [45/259]  total_loss: 5.617  soft_target_cross_entropy_loss: 2.695  loss_ofl: 2.928  mask_loss: 0  time: 0.7525  data_time: 0.0996  lr: 0.00019967  max_mem: 21179M
[07/04 18:43:03] pts.utils.events INFO:  eta: 1:49:56  iter: 1649 -- [95/259]  total_loss: 5.263  soft_target_cross_entropy_loss: 2.496  loss_ofl: 2.8  mask_loss: 0  time: 0.7530  data_time: 0.2217  lr: 0.00019955  max_mem: 21179M
[07/04 18:43:39] pts.utils.events INFO:  eta: 1:49:22  iter: 1699 -- [145/259]  total_loss: 5.379  soft_target_cross_entropy_loss: 2.491  loss_ofl: 2.799  mask_loss: 0  time: 0.7512  data_time: 0.1508  lr: 0.00019941  max_mem: 21179M
[07/04 18:44:15] pts.utils.events INFO:  eta: 1:48:48  iter: 1749 -- [195/259]  total_loss: 5.459  soft_target_cross_entropy_loss: 2.709  loss_ofl: 2.794  mask_loss: 0  time: 0.7502  data_time: 0.1879  lr: 0.00019926  max_mem: 21179M
[07/04 18:44:47] pts.utils.events INFO:  eta: 1:48:18  iter: 1799 -- [245/259]  total_loss: 5.189  soft_target_cross_entropy_loss: 2.598  loss_ofl: 2.669  mask_loss: 0  time: 0.7469  data_time: 0.0177  lr: 0.00019909  max_mem: 21179M
[07/04 18:44:57] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 18:45:39] pts.utils.events INFO:  eta: 1:47:55  iter: 1849 -- [36/259]  total_loss: 5.108  soft_target_cross_entropy_loss: 2.576  loss_ofl: 2.592  mask_loss: 0  time: 0.7532  data_time: 0.0490  lr: 0.0001989  max_mem: 21179M
[07/04 18:46:18] pts.utils.events INFO:  eta: 1:47:29  iter: 1899 -- [86/259]  total_loss: 5.332  soft_target_cross_entropy_loss: 2.592  loss_ofl: 2.722  mask_loss: 0  time: 0.7536  data_time: 0.1250  lr: 0.00019869  max_mem: 21179M
[07/04 18:46:54] pts.utils.events INFO:  eta: 1:47:01  iter: 1949 -- [136/259]  total_loss: 5.026  soft_target_cross_entropy_loss: 2.411  loss_ofl: 2.599  mask_loss: 0  time: 0.7525  data_time: 0.0774  lr: 0.00019846  max_mem: 21179M
[07/04 18:47:36] pts.utils.events INFO:  eta: 1:46:30  iter: 1999 -- [186/259]  total_loss: 5.107  soft_target_cross_entropy_loss: 2.544  loss_ofl: 2.521  mask_loss: 0  time: 0.7541  data_time: 0.1118  lr: 0.00019822  max_mem: 21179M
[07/04 18:48:15] pts.utils.events INFO:  eta: 1:46:00  iter: 2049 -- [236/259]  total_loss: 5.035  soft_target_cross_entropy_loss: 2.498  loss_ofl: 2.568  mask_loss: 0  time: 0.7545  data_time: 0.2607  lr: 0.00019796  max_mem: 21179M
[07/04 18:48:29] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 18:49:04] pts.utils.events INFO:  eta: 1:45:31  iter: 2099 -- [27/259]  total_loss: 5.015  soft_target_cross_entropy_loss: 2.463  loss_ofl: 2.521  mask_loss: 0  time: 0.7589  data_time: 0.0755  lr: 0.00019768  max_mem: 21179M
[07/04 18:49:41] pts.utils.events INFO:  eta: 1:44:58  iter: 2149 -- [77/259]  total_loss: 4.937  soft_target_cross_entropy_loss: 2.498  loss_ofl: 2.426  mask_loss: 0  time: 0.7579  data_time: 0.0577  lr: 0.00019738  max_mem: 21179M
[07/04 18:50:16] pts.utils.events INFO:  eta: 1:44:28  iter: 2199 -- [127/259]  total_loss: 4.812  soft_target_cross_entropy_loss: 2.412  loss_ofl: 2.454  mask_loss: 0  time: 0.7562  data_time: 0.0375  lr: 0.00019707  max_mem: 21179M
[07/04 18:50:53] pts.utils.events INFO:  eta: 1:43:59  iter: 2249 -- [177/259]  total_loss: 4.992  soft_target_cross_entropy_loss: 2.456  loss_ofl: 2.499  mask_loss: 0  time: 0.7558  data_time: 0.1546  lr: 0.00019674  max_mem: 21179M
[07/04 18:51:28] pts.utils.events INFO:  eta: 1:43:36  iter: 2299 -- [227/259]  total_loss: 4.921  soft_target_cross_entropy_loss: 2.609  loss_ofl: 2.342  mask_loss: 0  time: 0.7540  data_time: 0.1362  lr: 0.00019639  max_mem: 21179M
[07/04 18:51:50] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 18:52:22] pts.utils.events INFO:  eta: 1:43:10  iter: 2349 -- [18/259]  total_loss: 4.705  soft_target_cross_entropy_loss: 2.342  loss_ofl: 2.384  mask_loss: 0  time: 0.7600  data_time: 0.8749  lr: 0.00019602  max_mem: 21179M
[07/04 18:52:59] pts.utils.events INFO:  eta: 1:42:41  iter: 2399 -- [68/259]  total_loss: 4.667  soft_target_cross_entropy_loss: 2.485  loss_ofl: 2.344  mask_loss: 0  time: 0.7595  data_time: 0.1075  lr: 0.00019563  max_mem: 21179M
[07/04 18:53:36] pts.utils.events INFO:  eta: 1:42:17  iter: 2449 -- [118/259]  total_loss: 4.528  soft_target_cross_entropy_loss: 2.327  loss_ofl: 2.238  mask_loss: 0  time: 0.7589  data_time: 0.1407  lr: 0.00019523  max_mem: 21179M
[07/04 18:54:11] pts.utils.events INFO:  eta: 1:41:51  iter: 2499 -- [168/259]  total_loss: 4.489  soft_target_cross_entropy_loss: 2.278  loss_ofl: 2.263  mask_loss: 0  time: 0.7571  data_time: 0.0465  lr: 0.00019481  max_mem: 21179M
[07/04 18:54:48] pts.utils.events INFO:  eta: 1:41:22  iter: 2549 -- [218/259]  total_loss: 4.646  soft_target_cross_entropy_loss: 2.435  loss_ofl: 2.232  mask_loss: 0  time: 0.7566  data_time: 0.0072  lr: 0.00019438  max_mem: 21179M
[07/04 18:56:19] pts.engine.hooks INFO: ############################## Test: 10 ##############################
[07/04 18:56:19] pts.engine.hooks INFO: ACC-1crop@1: 0.6681503057479858
[07/04 18:56:19] pts.engine.hooks INFO: ACC-1crop@5: 0.9411473274230957
[07/04 18:56:19] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 18:56:21] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/best.pth
[07/04 18:56:42] pts.utils.events INFO:  eta: 1:40:55  iter: 2599 -- [9/259]  total_loss: 4.506  soft_target_cross_entropy_loss: 2.299  loss_ofl: 2.228  mask_loss: 0  time: 0.7599  data_time: 0.7212  lr: 0.00019393  max_mem: 21179M
[07/04 18:57:18] pts.utils.events INFO:  eta: 1:40:19  iter: 2649 -- [59/259]  total_loss: 4.513  soft_target_cross_entropy_loss: 2.262  loss_ofl: 2.228  mask_loss: 0  time: 0.7589  data_time: 0.0335  lr: 0.00019346  max_mem: 21179M
[07/04 18:57:56] pts.utils.events INFO:  eta: 1:39:46  iter: 2699 -- [109/259]  total_loss: 4.529  soft_target_cross_entropy_loss: 2.322  loss_ofl: 2.225  mask_loss: 0  time: 0.7584  data_time: 0.2154  lr: 0.00019297  max_mem: 21179M
[07/04 18:58:31] pts.utils.events INFO:  eta: 1:39:13  iter: 2749 -- [159/259]  total_loss: 4.477  soft_target_cross_entropy_loss: 2.296  loss_ofl: 2.199  mask_loss: 0  time: 0.7570  data_time: 0.1128  lr: 0.00019247  max_mem: 21179M
[07/04 18:59:10] pts.utils.events INFO:  eta: 1:38:45  iter: 2799 -- [209/259]  total_loss: 4.631  soft_target_cross_entropy_loss: 2.432  loss_ofl: 2.217  mask_loss: 0  time: 0.7571  data_time: 0.2640  lr: 0.00019195  max_mem: 21179M
[07/04 18:59:45] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:00:01] pts.utils.events INFO:  eta: 1:38:15  iter: 2849 -- [0/259]  total_loss: 4.519  soft_target_cross_entropy_loss: 2.379  loss_ofl: 2.18  mask_loss: 0  time: 0.7611  data_time: 0.8390  lr: 0.00019141  max_mem: 21179M
[07/04 19:00:38] pts.utils.events INFO:  eta: 1:37:44  iter: 2899 -- [50/259]  total_loss: 4.352  soft_target_cross_entropy_loss: 2.232  loss_ofl: 2.13  mask_loss: 0  time: 0.7607  data_time: 0.1565  lr: 0.00019086  max_mem: 21179M
[07/04 19:01:15] pts.utils.events INFO:  eta: 1:37:15  iter: 2949 -- [100/259]  total_loss: 4.432  soft_target_cross_entropy_loss: 2.324  loss_ofl: 2.078  mask_loss: 0  time: 0.7600  data_time: 0.1909  lr: 0.00019029  max_mem: 21179M
[07/04 19:01:52] pts.utils.events INFO:  eta: 1:36:47  iter: 2999 -- [150/259]  total_loss: 4.517  soft_target_cross_entropy_loss: 2.402  loss_ofl: 2.193  mask_loss: 0  time: 0.7594  data_time: 0.0942  lr: 0.0001897  max_mem: 21179M
[07/04 19:02:27] pts.utils.events INFO:  eta: 1:36:18  iter: 3049 -- [200/259]  total_loss: 4.454  soft_target_cross_entropy_loss: 2.309  loss_ofl: 2.165  mask_loss: 0  time: 0.7582  data_time: 0.0936  lr: 0.0001891  max_mem: 21179M
[07/04 19:03:02] pts.utils.events INFO:  eta: 1:35:54  iter: 3099 -- [250/259]  total_loss: 4.33  soft_target_cross_entropy_loss: 2.183  loss_ofl: 2.16  mask_loss: 0  time: 0.7571  data_time: 0.1241  lr: 0.00018848  max_mem: 21179M
[07/04 19:03:08] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:03:53] pts.utils.events INFO:  eta: 1:35:24  iter: 3149 -- [41/259]  total_loss: 4.257  soft_target_cross_entropy_loss: 2.205  loss_ofl: 2.053  mask_loss: 0  time: 0.7604  data_time: 0.1476  lr: 0.00018784  max_mem: 21179M
[07/04 19:04:28] pts.utils.events INFO:  eta: 1:34:53  iter: 3199 -- [91/259]  total_loss: 4.405  soft_target_cross_entropy_loss: 2.294  loss_ofl: 2.189  mask_loss: 0  time: 0.7593  data_time: 0.1852  lr: 0.00018719  max_mem: 21179M
[07/04 19:05:01] pts.utils.events INFO:  eta: 1:34:25  iter: 3249 -- [141/259]  total_loss: 4.306  soft_target_cross_entropy_loss: 2.194  loss_ofl: 2.109  mask_loss: 0  time: 0.7576  data_time: 0.0910  lr: 0.00018653  max_mem: 21179M
[07/04 19:05:38] pts.utils.events INFO:  eta: 1:33:56  iter: 3299 -- [191/259]  total_loss: 4.3  soft_target_cross_entropy_loss: 2.283  loss_ofl: 1.991  mask_loss: 0  time: 0.7570  data_time: 0.0697  lr: 0.00018585  max_mem: 21179M
[07/04 19:06:14] pts.utils.events INFO:  eta: 1:33:33  iter: 3349 -- [241/259]  total_loss: 4.32  soft_target_cross_entropy_loss: 2.307  loss_ofl: 2.019  mask_loss: 0  time: 0.7563  data_time: 0.0621  lr: 0.00018515  max_mem: 21179M
[07/04 19:06:27] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:07:06] pts.utils.events INFO:  eta: 1:33:04  iter: 3399 -- [32/259]  total_loss: 4.17  soft_target_cross_entropy_loss: 2.146  loss_ofl: 1.976  mask_loss: 0  time: 0.7599  data_time: 0.1010  lr: 0.00018444  max_mem: 21179M
[07/04 19:07:43] pts.utils.events INFO:  eta: 1:32:31  iter: 3449 -- [82/259]  total_loss: 4.161  soft_target_cross_entropy_loss: 2.15  loss_ofl: 2.002  mask_loss: 0  time: 0.7592  data_time: 0.0992  lr: 0.00018371  max_mem: 21179M
[07/04 19:08:16] pts.utils.events INFO:  eta: 1:32:02  iter: 3499 -- [132/259]  total_loss: 4.339  soft_target_cross_entropy_loss: 2.254  loss_ofl: 2.056  mask_loss: 0  time: 0.7577  data_time: 0.0166  lr: 0.00018297  max_mem: 21179M
[07/04 19:08:53] pts.utils.events INFO:  eta: 1:31:33  iter: 3549 -- [182/259]  total_loss: 4.31  soft_target_cross_entropy_loss: 2.293  loss_ofl: 2.041  mask_loss: 0  time: 0.7573  data_time: 0.1562  lr: 0.00018221  max_mem: 21179M
[07/04 19:09:31] pts.utils.events INFO:  eta: 1:31:09  iter: 3599 -- [232/259]  total_loss: 4.136  soft_target_cross_entropy_loss: 2.17  loss_ofl: 2.007  mask_loss: 0  time: 0.7569  data_time: 0.1120  lr: 0.00018144  max_mem: 21179M
[07/04 19:09:50] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:10:23] pts.utils.events INFO:  eta: 1:30:44  iter: 3649 -- [23/259]  total_loss: 3.983  soft_target_cross_entropy_loss: 2.032  loss_ofl: 1.958  mask_loss: 0  time: 0.7604  data_time: 0.1516  lr: 0.00018065  max_mem: 21179M
[07/04 19:10:59] pts.utils.events INFO:  eta: 1:30:14  iter: 3699 -- [73/259]  total_loss: 4.218  soft_target_cross_entropy_loss: 2.245  loss_ofl: 1.994  mask_loss: 0  time: 0.7596  data_time: 0.0933  lr: 0.00017985  max_mem: 21179M
[07/04 19:11:36] pts.utils.events INFO:  eta: 1:29:52  iter: 3749 -- [123/259]  total_loss: 4.078  soft_target_cross_entropy_loss: 2.188  loss_ofl: 1.968  mask_loss: 0  time: 0.7591  data_time: 0.1595  lr: 0.00017903  max_mem: 21179M
[07/04 19:12:10] pts.utils.events INFO:  eta: 1:29:24  iter: 3799 -- [173/259]  total_loss: 4.026  soft_target_cross_entropy_loss: 2.192  loss_ofl: 1.958  mask_loss: 0  time: 0.7579  data_time: 0.0955  lr: 0.0001782  max_mem: 21179M
[07/04 19:12:48] pts.utils.events INFO:  eta: 1:28:57  iter: 3849 -- [223/259]  total_loss: 3.995  soft_target_cross_entropy_loss: 2.073  loss_ofl: 1.913  mask_loss: 0  time: 0.7576  data_time: 0.0677  lr: 0.00017736  max_mem: 21179M
[07/04 19:14:18] pts.engine.hooks INFO: ############################## Test: 15 ##############################
[07/04 19:14:18] pts.engine.hooks INFO: ACC-1crop@1: 0.6879327297210693
[07/04 19:14:18] pts.engine.hooks INFO: ACC-1crop@5: 0.9554895758628845
[07/04 19:14:18] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:14:20] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/best.pth
[07/04 19:14:45] pts.utils.events INFO:  eta: 1:28:32  iter: 3899 -- [14/259]  total_loss: 4.044  soft_target_cross_entropy_loss: 2.085  loss_ofl: 1.965  mask_loss: 0  time: 0.7606  data_time: 0.8018  lr: 0.0001765  max_mem: 21179M
[07/04 19:15:22] pts.utils.events INFO:  eta: 1:27:57  iter: 3949 -- [64/259]  total_loss: 3.915  soft_target_cross_entropy_loss: 2.012  loss_ofl: 1.834  mask_loss: 0  time: 0.7599  data_time: 0.1837  lr: 0.00017562  max_mem: 21179M
[07/04 19:15:58] pts.utils.events INFO:  eta: 1:27:26  iter: 3999 -- [114/259]  total_loss: 4.039  soft_target_cross_entropy_loss: 2.093  loss_ofl: 1.925  mask_loss: 0  time: 0.7592  data_time: 0.1149  lr: 0.00017474  max_mem: 21179M
[07/04 19:16:32] pts.utils.events INFO:  eta: 1:26:57  iter: 4049 -- [164/259]  total_loss: 3.973  soft_target_cross_entropy_loss: 2.143  loss_ofl: 1.875  mask_loss: 0  time: 0.7581  data_time: 0.0320  lr: 0.00017384  max_mem: 21179M
[07/04 19:17:10] pts.utils.events INFO:  eta: 1:26:28  iter: 4099 -- [214/259]  total_loss: 4.109  soft_target_cross_entropy_loss: 2.108  loss_ofl: 1.935  mask_loss: 0  time: 0.7579  data_time: 0.2235  lr: 0.00017293  max_mem: 21179M
[07/04 19:17:42] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:18:04] pts.utils.events INFO:  eta: 1:26:05  iter: 4149 -- [5/259]  total_loss: 4.037  soft_target_cross_entropy_loss: 2.131  loss_ofl: 1.908  mask_loss: 0  time: 0.7612  data_time: 0.9737  lr: 0.000172  max_mem: 21179M
[07/04 19:18:38] pts.utils.events INFO:  eta: 1:25:30  iter: 4199 -- [55/259]  total_loss: 4.005  soft_target_cross_entropy_loss: 2.094  loss_ofl: 1.905  mask_loss: 0  time: 0.7602  data_time: 0.1035  lr: 0.00017106  max_mem: 21179M
[07/04 19:19:13] pts.utils.events INFO:  eta: 1:24:59  iter: 4249 -- [105/259]  total_loss: 3.807  soft_target_cross_entropy_loss: 2.011  loss_ofl: 1.817  mask_loss: 0  time: 0.7595  data_time: 0.1291  lr: 0.00017011  max_mem: 21179M
[07/04 19:19:52] pts.utils.events INFO:  eta: 1:24:26  iter: 4299 -- [155/259]  total_loss: 3.973  soft_target_cross_entropy_loss: 2.124  loss_ofl: 1.827  mask_loss: 0  time: 0.7594  data_time: 0.2411  lr: 0.00016914  max_mem: 21179M
[07/04 19:20:30] pts.utils.events INFO:  eta: 1:23:54  iter: 4349 -- [205/259]  total_loss: 3.898  soft_target_cross_entropy_loss: 2.121  loss_ofl: 1.773  mask_loss: 0  time: 0.7593  data_time: 0.1430  lr: 0.00016817  max_mem: 21179M
[07/04 19:21:08] pts.utils.events INFO:  eta: 1:23:26  iter: 4399 -- [255/259]  total_loss: 3.942  soft_target_cross_entropy_loss: 2.088  loss_ofl: 1.85  mask_loss: 0  time: 0.7591  data_time: 0.2785  lr: 0.00016718  max_mem: 21179M
[07/04 19:21:10] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:22:00] pts.utils.events INFO:  eta: 1:22:55  iter: 4449 -- [46/259]  total_loss: 3.852  soft_target_cross_entropy_loss: 2.049  loss_ofl: 1.768  mask_loss: 0  time: 0.7617  data_time: 0.0504  lr: 0.00016618  max_mem: 21179M
[07/04 19:22:36] pts.utils.events INFO:  eta: 1:22:22  iter: 4499 -- [96/259]  total_loss: 3.878  soft_target_cross_entropy_loss: 2.026  loss_ofl: 1.759  mask_loss: 0  time: 0.7612  data_time: 0.1494  lr: 0.00016516  max_mem: 21179M
[07/04 19:23:14] pts.utils.events INFO:  eta: 1:21:50  iter: 4549 -- [146/259]  total_loss: 3.861  soft_target_cross_entropy_loss: 2.05  loss_ofl: 1.816  mask_loss: 0  time: 0.7610  data_time: 0.1556  lr: 0.00016414  max_mem: 21179M
[07/04 19:23:52] pts.utils.events INFO:  eta: 1:21:19  iter: 4599 -- [196/259]  total_loss: 3.729  soft_target_cross_entropy_loss: 1.964  loss_ofl: 1.797  mask_loss: 0  time: 0.7608  data_time: 0.0834  lr: 0.0001631  max_mem: 21179M
[07/04 19:24:27] pts.utils.events INFO:  eta: 1:20:54  iter: 4649 -- [246/259]  total_loss: 3.815  soft_target_cross_entropy_loss: 2.103  loss_ofl: 1.804  mask_loss: 0  time: 0.7601  data_time: 0.0671  lr: 0.00016205  max_mem: 21179M
[07/04 19:24:36] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:25:28] pts.utils.events INFO:  eta: 1:20:29  iter: 4699 -- [37/259]  total_loss: 3.87  soft_target_cross_entropy_loss: 2.046  loss_ofl: 1.843  mask_loss: 0  time: 0.7645  data_time: 0.1111  lr: 0.00016099  max_mem: 21179M
[07/04 19:26:06] pts.utils.events INFO:  eta: 1:19:56  iter: 4749 -- [87/259]  total_loss: 3.75  soft_target_cross_entropy_loss: 2.025  loss_ofl: 1.72  mask_loss: 9.928e-05  time: 0.7642  data_time: 0.1238  lr: 0.00015992  max_mem: 21179M
[07/04 19:26:43] pts.utils.events INFO:  eta: 1:19:23  iter: 4799 -- [137/259]  total_loss: 3.883  soft_target_cross_entropy_loss: 2.069  loss_ofl: 1.836  mask_loss: 0  time: 0.7638  data_time: 0.1366  lr: 0.00015884  max_mem: 21179M
[07/04 19:27:20] pts.utils.events INFO:  eta: 1:18:54  iter: 4849 -- [187/259]  total_loss: 3.724  soft_target_cross_entropy_loss: 1.998  loss_ofl: 1.732  mask_loss: 0  time: 0.7635  data_time: 0.1573  lr: 0.00015775  max_mem: 21179M
[07/04 19:27:54] pts.utils.events INFO:  eta: 1:18:25  iter: 4899 -- [237/259]  total_loss: 3.758  soft_target_cross_entropy_loss: 1.975  loss_ofl: 1.818  mask_loss: 0  time: 0.7625  data_time: 0.1327  lr: 0.00015665  max_mem: 21179M
[07/04 19:28:11] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:28:47] pts.utils.events INFO:  eta: 1:17:59  iter: 4949 -- [28/259]  total_loss: 3.632  soft_target_cross_entropy_loss: 1.905  loss_ofl: 1.706  mask_loss: 0  time: 0.7651  data_time: 0.0575  lr: 0.00015554  max_mem: 21179M
[07/04 19:29:24] pts.utils.events INFO:  eta: 1:17:30  iter: 4999 -- [78/259]  total_loss: 3.602  soft_target_cross_entropy_loss: 1.95  loss_ofl: 1.726  mask_loss: 0  time: 0.7647  data_time: 0.1731  lr: 0.00015442  max_mem: 21179M
[07/04 19:30:03] pts.utils.events INFO:  eta: 1:16:59  iter: 5049 -- [128/259]  total_loss: 3.826  soft_target_cross_entropy_loss: 2.014  loss_ofl: 1.899  mask_loss: 0  time: 0.7646  data_time: 0.1636  lr: 0.00015328  max_mem: 21179M
[07/04 19:30:39] pts.utils.events INFO:  eta: 1:16:28  iter: 5099 -- [178/259]  total_loss: 3.707  soft_target_cross_entropy_loss: 1.98  loss_ofl: 1.799  mask_loss: 0  time: 0.7640  data_time: 0.0677  lr: 0.00015214  max_mem: 21179M
[07/04 19:31:14] pts.utils.events INFO:  eta: 1:15:58  iter: 5149 -- [228/259]  total_loss: 3.757  soft_target_cross_entropy_loss: 1.953  loss_ofl: 1.842  mask_loss: 0  time: 0.7632  data_time: 0.1686  lr: 0.00015099  max_mem: 21179M
[07/04 19:32:39] pts.engine.hooks INFO: ############################## Test: 20 ##############################
[07/04 19:32:39] pts.engine.hooks INFO: ACC-1crop@1: 0.681503415107727
[07/04 19:32:39] pts.engine.hooks INFO: ACC-1crop@5: 0.9545004367828369
[07/04 19:32:39] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:33:11] pts.utils.events INFO:  eta: 1:15:32  iter: 5199 -- [19/259]  total_loss: 3.923  soft_target_cross_entropy_loss: 2.083  loss_ofl: 1.852  mask_loss: 0  time: 0.7657  data_time: 0.9537  lr: 0.00014983  max_mem: 21179M
[07/04 19:33:47] pts.utils.events INFO:  eta: 1:15:01  iter: 5249 -- [69/259]  total_loss: 3.647  soft_target_cross_entropy_loss: 1.971  loss_ofl: 1.699  mask_loss: 0  time: 0.7652  data_time: 0.0919  lr: 0.00014866  max_mem: 21179M
[07/04 19:34:21] pts.utils.events INFO:  eta: 1:14:31  iter: 5299 -- [119/259]  total_loss: 3.638  soft_target_cross_entropy_loss: 1.887  loss_ofl: 1.761  mask_loss: 0  time: 0.7643  data_time: 0.1164  lr: 0.00014748  max_mem: 21179M
[07/04 19:34:58] pts.utils.events INFO:  eta: 1:14:02  iter: 5349 -- [169/259]  total_loss: 3.663  soft_target_cross_entropy_loss: 1.973  loss_ofl: 1.727  mask_loss: 0  time: 0.7638  data_time: 0.2009  lr: 0.0001463  max_mem: 21179M
[07/04 19:35:34] pts.utils.events INFO:  eta: 1:13:33  iter: 5399 -- [219/259]  total_loss: 3.56  soft_target_cross_entropy_loss: 1.931  loss_ofl: 1.717  mask_loss: 0  time: 0.7634  data_time: 0.0799  lr: 0.0001451  max_mem: 21179M
[07/04 19:36:03] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:36:30] pts.utils.events INFO:  eta: 1:13:07  iter: 5449 -- [10/259]  total_loss: 3.671  soft_target_cross_entropy_loss: 1.924  loss_ofl: 1.727  mask_loss: 0  time: 0.7661  data_time: 1.0840  lr: 0.0001439  max_mem: 21179M
[07/04 19:37:07] pts.utils.events INFO:  eta: 1:12:37  iter: 5499 -- [60/259]  total_loss: 3.374  soft_target_cross_entropy_loss: 1.769  loss_ofl: 1.624  mask_loss: 0  time: 0.7658  data_time: 0.1033  lr: 0.00014269  max_mem: 21179M
[07/04 19:37:45] pts.utils.events INFO:  eta: 1:12:12  iter: 5549 -- [110/259]  total_loss: 3.555  soft_target_cross_entropy_loss: 1.9  loss_ofl: 1.644  mask_loss: 0  time: 0.7656  data_time: 0.1040  lr: 0.00014147  max_mem: 21179M
[07/04 19:38:23] pts.utils.events INFO:  eta: 1:11:44  iter: 5599 -- [160/259]  total_loss: 3.602  soft_target_cross_entropy_loss: 1.869  loss_ofl: 1.747  mask_loss: 0  time: 0.7654  data_time: 0.1245  lr: 0.00014025  max_mem: 21179M
[07/04 19:38:59] pts.utils.events INFO:  eta: 1:11:15  iter: 5649 -- [210/259]  total_loss: 3.572  soft_target_cross_entropy_loss: 1.902  loss_ofl: 1.675  mask_loss: 0  time: 0.7648  data_time: 0.1296  lr: 0.00013901  max_mem: 21179M
[07/04 19:39:32] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:39:49] pts.utils.events INFO:  eta: 1:10:48  iter: 5699 -- [1/259]  total_loss: 3.627  soft_target_cross_entropy_loss: 1.834  loss_ofl: 1.694  mask_loss: 0  time: 0.7666  data_time: 0.8051  lr: 0.00013777  max_mem: 21179M
[07/04 19:40:24] pts.utils.events INFO:  eta: 1:10:19  iter: 5749 -- [51/259]  total_loss: 3.592  soft_target_cross_entropy_loss: 1.916  loss_ofl: 1.706  mask_loss: 0  time: 0.7658  data_time: 0.0399  lr: 0.00013653  max_mem: 21179M
[07/04 19:41:00] pts.utils.events INFO:  eta: 1:09:51  iter: 5799 -- [101/259]  total_loss: 3.565  soft_target_cross_entropy_loss: 1.887  loss_ofl: 1.739  mask_loss: 0  time: 0.7653  data_time: 0.1071  lr: 0.00013527  max_mem: 21179M
[07/04 19:41:36] pts.utils.events INFO:  eta: 1:09:23  iter: 5849 -- [151/259]  total_loss: 3.39  soft_target_cross_entropy_loss: 1.813  loss_ofl: 1.624  mask_loss: 0  time: 0.7648  data_time: 0.0858  lr: 0.00013401  max_mem: 21179M
[07/04 19:42:11] pts.utils.events INFO:  eta: 1:08:54  iter: 5899 -- [201/259]  total_loss: 3.714  soft_target_cross_entropy_loss: 1.929  loss_ofl: 1.741  mask_loss: 0  time: 0.7642  data_time: 0.0740  lr: 0.00013275  max_mem: 21179M
[07/04 19:42:48] pts.utils.events INFO:  eta: 1:08:26  iter: 5949 -- [251/259]  total_loss: 3.545  soft_target_cross_entropy_loss: 1.902  loss_ofl: 1.667  mask_loss: 0  time: 0.7638  data_time: 0.0981  lr: 0.00013148  max_mem: 21179M
[07/04 19:42:53] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:43:42] pts.utils.events INFO:  eta: 1:07:56  iter: 5999 -- [42/259]  total_loss: 3.578  soft_target_cross_entropy_loss: 1.915  loss_ofl: 1.679  mask_loss: 0  time: 0.7661  data_time: 0.1902  lr: 0.0001302  max_mem: 21179M
[07/04 19:44:18] pts.utils.events INFO:  eta: 1:07:25  iter: 6049 -- [92/259]  total_loss: 3.54  soft_target_cross_entropy_loss: 1.88  loss_ofl: 1.723  mask_loss: 0  time: 0.7656  data_time: 0.1402  lr: 0.00012892  max_mem: 21179M
[07/04 19:44:52] pts.utils.events INFO:  eta: 1:06:57  iter: 6099 -- [142/259]  total_loss: 3.443  soft_target_cross_entropy_loss: 1.883  loss_ofl: 1.625  mask_loss: 0  time: 0.7649  data_time: 0.1148  lr: 0.00012763  max_mem: 21179M
[07/04 19:45:25] pts.utils.events INFO:  eta: 1:06:28  iter: 6149 -- [192/259]  total_loss: 3.51  soft_target_cross_entropy_loss: 1.827  loss_ofl: 1.651  mask_loss: 0  time: 0.7639  data_time: 0.0899  lr: 0.00012634  max_mem: 21179M
[07/04 19:45:59] pts.utils.events INFO:  eta: 1:05:59  iter: 6199 -- [242/259]  total_loss: 3.498  soft_target_cross_entropy_loss: 1.717  loss_ofl: 1.665  mask_loss: 0  time: 0.7631  data_time: 0.0712  lr: 0.00012504  max_mem: 21179M
[07/04 19:46:12] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:46:52] pts.utils.events INFO:  eta: 1:05:29  iter: 6249 -- [33/259]  total_loss: 3.38  soft_target_cross_entropy_loss: 1.84  loss_ofl: 1.583  mask_loss: 0  time: 0.7651  data_time: 0.1682  lr: 0.00012374  max_mem: 21179M
[07/04 19:47:25] pts.utils.events INFO:  eta: 1:05:00  iter: 6299 -- [83/259]  total_loss: 3.419  soft_target_cross_entropy_loss: 1.812  loss_ofl: 1.684  mask_loss: 0  time: 0.7642  data_time: 0.0502  lr: 0.00012243  max_mem: 21179M
[07/04 19:48:02] pts.utils.events INFO:  eta: 1:04:31  iter: 6349 -- [133/259]  total_loss: 3.569  soft_target_cross_entropy_loss: 1.802  loss_ofl: 1.65  mask_loss: 0  time: 0.7639  data_time: 0.1382  lr: 0.00012112  max_mem: 21179M
[07/04 19:48:38] pts.utils.events INFO:  eta: 1:04:02  iter: 6399 -- [183/259]  total_loss: 3.56  soft_target_cross_entropy_loss: 1.863  loss_ofl: 1.705  mask_loss: 0  time: 0.7634  data_time: 0.0995  lr: 0.00011981  max_mem: 21179M
[07/04 19:49:21] pts.utils.events INFO:  eta: 1:03:35  iter: 6449 -- [233/259]  total_loss: 3.429  soft_target_cross_entropy_loss: 1.89  loss_ofl: 1.625  mask_loss: 0  time: 0.7641  data_time: 0.2897  lr: 0.00011849  max_mem: 21179M
[07/04 19:50:42] pts.engine.hooks INFO: ############################## Test: 25 ##############################
[07/04 19:50:42] pts.engine.hooks INFO: ACC-1crop@1: 0.678536057472229
[07/04 19:50:42] pts.engine.hooks INFO: ACC-1crop@5: 0.9391691088676453
[07/04 19:50:42] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:51:13] pts.utils.events INFO:  eta: 1:03:06  iter: 6499 -- [24/259]  total_loss: 3.242  soft_target_cross_entropy_loss: 1.714  loss_ofl: 1.576  mask_loss: 0  time: 0.7653  data_time: 0.0629  lr: 0.00011717  max_mem: 21179M
[07/04 19:51:51] pts.utils.events INFO:  eta: 1:02:33  iter: 6549 -- [74/259]  total_loss: 3.458  soft_target_cross_entropy_loss: 1.779  loss_ofl: 1.615  mask_loss: 0  time: 0.7651  data_time: 0.1658  lr: 0.00011585  max_mem: 21179M
[07/04 19:52:27] pts.utils.events INFO:  eta: 1:02:01  iter: 6599 -- [124/259]  total_loss: 3.324  soft_target_cross_entropy_loss: 1.747  loss_ofl: 1.59  mask_loss: 0  time: 0.7646  data_time: 0.1564  lr: 0.00011452  max_mem: 21179M
[07/04 19:53:04] pts.utils.events INFO:  eta: 1:01:27  iter: 6649 -- [174/259]  total_loss: 3.487  soft_target_cross_entropy_loss: 1.894  loss_ofl: 1.626  mask_loss: 0  time: 0.7643  data_time: 0.1399  lr: 0.00011319  max_mem: 21179M
[07/04 19:53:40] pts.utils.events INFO:  eta: 1:00:58  iter: 6699 -- [224/259]  total_loss: 3.296  soft_target_cross_entropy_loss: 1.811  loss_ofl: 1.554  mask_loss: 0  time: 0.7639  data_time: 0.1431  lr: 0.00011186  max_mem: 21179M
[07/04 19:54:05] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:54:32] pts.utils.events INFO:  eta: 1:00:30  iter: 6749 -- [15/259]  total_loss: 3.304  soft_target_cross_entropy_loss: 1.734  loss_ofl: 1.575  mask_loss: 0  time: 0.7656  data_time: 0.8892  lr: 0.00011053  max_mem: 21179M
[07/04 19:55:11] pts.utils.events INFO:  eta: 0:59:57  iter: 6799 -- [65/259]  total_loss: 3.356  soft_target_cross_entropy_loss: 1.781  loss_ofl: 1.622  mask_loss: 0  time: 0.7657  data_time: 0.0685  lr: 0.00010919  max_mem: 21179M
[07/04 19:55:50] pts.utils.events INFO:  eta: 0:59:26  iter: 6849 -- [115/259]  total_loss: 3.277  soft_target_cross_entropy_loss: 1.762  loss_ofl: 1.576  mask_loss: 0  time: 0.7657  data_time: 0.1928  lr: 0.00010786  max_mem: 21179M
[07/04 19:56:25] pts.utils.events INFO:  eta: 0:58:56  iter: 6899 -- [165/259]  total_loss: 3.183  soft_target_cross_entropy_loss: 1.719  loss_ofl: 1.512  mask_loss: 0  time: 0.7651  data_time: 0.1152  lr: 0.00010652  max_mem: 21179M
[07/04 19:57:01] pts.utils.events INFO:  eta: 0:58:28  iter: 6949 -- [215/259]  total_loss: 3.372  soft_target_cross_entropy_loss: 1.844  loss_ofl: 1.595  mask_loss: 0  time: 0.7646  data_time: 0.0960  lr: 0.00010518  max_mem: 21179M
[07/04 19:57:31] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 19:57:54] pts.utils.events INFO:  eta: 0:58:06  iter: 6999 -- [6/259]  total_loss: 3.216  soft_target_cross_entropy_loss: 1.682  loss_ofl: 1.534  mask_loss: 0  time: 0.7664  data_time: 0.9235  lr: 0.00010384  max_mem: 21179M
[07/04 19:58:39] pts.utils.events INFO:  eta: 0:57:39  iter: 7049 -- [56/259]  total_loss: 3.204  soft_target_cross_entropy_loss: 1.628  loss_ofl: 1.592  mask_loss: 0  time: 0.7672  data_time: 0.0648  lr: 0.0001025  max_mem: 21179M
[07/04 19:59:15] pts.utils.events INFO:  eta: 0:57:04  iter: 7099 -- [106/259]  total_loss: 3.251  soft_target_cross_entropy_loss: 1.706  loss_ofl: 1.564  mask_loss: 0  time: 0.7667  data_time: 0.1666  lr: 0.00010116  max_mem: 21179M
[07/04 19:59:50] pts.utils.events INFO:  eta: 0:56:36  iter: 7149 -- [156/259]  total_loss: 3.362  soft_target_cross_entropy_loss: 1.758  loss_ofl: 1.605  mask_loss: 0  time: 0.7662  data_time: 0.1057  lr: 9.9816e-05  max_mem: 21179M
[07/04 20:00:30] pts.utils.events INFO:  eta: 0:56:07  iter: 7199 -- [206/259]  total_loss: 3.256  soft_target_cross_entropy_loss: 1.723  loss_ofl: 1.539  mask_loss: 0  time: 0.7664  data_time: 0.3224  lr: 9.8475e-05  max_mem: 21179M
[07/04 20:01:08] pts.utils.events INFO:  eta: 0:55:43  iter: 7249 -- [256/259]  total_loss: 3.357  soft_target_cross_entropy_loss: 1.754  loss_ofl: 1.571  mask_loss: 0  time: 0.7662  data_time: 0.2587  lr: 9.7135e-05  max_mem: 21179M
[07/04 20:01:09] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:02:04] pts.utils.events INFO:  eta: 0:55:13  iter: 7299 -- [47/259]  total_loss: 3.217  soft_target_cross_entropy_loss: 1.669  loss_ofl: 1.543  mask_loss: 0  time: 0.7684  data_time: 0.3593  lr: 9.5795e-05  max_mem: 21179M
[07/04 20:02:40] pts.utils.events INFO:  eta: 0:54:44  iter: 7349 -- [97/259]  total_loss: 3.167  soft_target_cross_entropy_loss: 1.652  loss_ofl: 1.525  mask_loss: 0  time: 0.7680  data_time: 0.1059  lr: 9.4456e-05  max_mem: 21179M
[07/04 20:03:14] pts.utils.events INFO:  eta: 0:54:15  iter: 7399 -- [147/259]  total_loss: 3.2  soft_target_cross_entropy_loss: 1.715  loss_ofl: 1.498  mask_loss: 0  time: 0.7673  data_time: 0.1168  lr: 9.3118e-05  max_mem: 21179M
[07/04 20:03:51] pts.utils.events INFO:  eta: 0:53:47  iter: 7449 -- [197/259]  total_loss: 3.073  soft_target_cross_entropy_loss: 1.641  loss_ofl: 1.456  mask_loss: 0  time: 0.7671  data_time: 0.0910  lr: 9.1781e-05  max_mem: 21179M
[07/04 20:04:29] pts.utils.events INFO:  eta: 0:53:21  iter: 7499 -- [247/259]  total_loss: 3.343  soft_target_cross_entropy_loss: 1.761  loss_ofl: 1.578  mask_loss: 0  time: 0.7668  data_time: 0.2588  lr: 9.0446e-05  max_mem: 21179M
[07/04 20:04:36] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:05:23] pts.utils.events INFO:  eta: 0:52:51  iter: 7549 -- [38/259]  total_loss: 3.068  soft_target_cross_entropy_loss: 1.705  loss_ofl: 1.445  mask_loss: 0  time: 0.7686  data_time: 0.1941  lr: 8.9113e-05  max_mem: 21179M
[07/04 20:05:57] pts.utils.events INFO:  eta: 0:52:23  iter: 7599 -- [88/259]  total_loss: 3.27  soft_target_cross_entropy_loss: 1.747  loss_ofl: 1.554  mask_loss: 0  time: 0.7680  data_time: 0.1172  lr: 8.7782e-05  max_mem: 21179M
[07/04 20:06:32] pts.utils.events INFO:  eta: 0:51:53  iter: 7649 -- [138/259]  total_loss: 3.25  soft_target_cross_entropy_loss: 1.649  loss_ofl: 1.562  mask_loss: 0  time: 0.7675  data_time: 0.1291  lr: 8.6453e-05  max_mem: 21179M
[07/04 20:07:07] pts.utils.events INFO:  eta: 0:51:25  iter: 7699 -- [188/259]  total_loss: 3.182  soft_target_cross_entropy_loss: 1.714  loss_ofl: 1.474  mask_loss: 0  time: 0.7669  data_time: 0.0856  lr: 8.5127e-05  max_mem: 21179M
[07/04 20:07:43] pts.utils.events INFO:  eta: 0:50:57  iter: 7749 -- [238/259]  total_loss: 3.236  soft_target_cross_entropy_loss: 1.681  loss_ofl: 1.574  mask_loss: 0  time: 0.7665  data_time: 0.1933  lr: 8.3803e-05  max_mem: 21179M
[07/04 20:09:04] pts.engine.hooks INFO: ############################## Test: 30 ##############################
[07/04 20:09:04] pts.engine.hooks INFO: ACC-1crop@1: 0.678536057472229
[07/04 20:09:04] pts.engine.hooks INFO: ACC-1crop@5: 0.9317507147789001
[07/04 20:09:04] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:09:40] pts.utils.events INFO:  eta: 0:50:27  iter: 7799 -- [29/259]  total_loss: 3.137  soft_target_cross_entropy_loss: 1.679  loss_ofl: 1.484  mask_loss: 0  time: 0.7680  data_time: 0.0754  lr: 8.2483e-05  max_mem: 21179M
[07/04 20:10:14] pts.utils.events INFO:  eta: 0:49:56  iter: 7849 -- [79/259]  total_loss: 3.182  soft_target_cross_entropy_loss: 1.663  loss_ofl: 1.54  mask_loss: 0  time: 0.7674  data_time: 0.0901  lr: 8.1166e-05  max_mem: 21179M
[07/04 20:10:50] pts.utils.events INFO:  eta: 0:49:26  iter: 7899 -- [129/259]  total_loss: 3.173  soft_target_cross_entropy_loss: 1.65  loss_ofl: 1.521  mask_loss: 0  time: 0.7670  data_time: 0.1328  lr: 7.9852e-05  max_mem: 21179M
[07/04 20:11:23] pts.utils.events INFO:  eta: 0:48:57  iter: 7949 -- [179/259]  total_loss: 3.249  soft_target_cross_entropy_loss: 1.682  loss_ofl: 1.489  mask_loss: 0  time: 0.7663  data_time: 0.1147  lr: 7.8542e-05  max_mem: 21179M
[07/04 20:11:59] pts.utils.events INFO:  eta: 0:48:26  iter: 7999 -- [229/259]  total_loss: 3.161  soft_target_cross_entropy_loss: 1.695  loss_ofl: 1.44  mask_loss: 0  time: 0.7658  data_time: 0.0738  lr: 7.7236e-05  max_mem: 21179M
[07/04 20:12:18] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:12:47] pts.utils.events INFO:  eta: 0:47:58  iter: 8049 -- [20/259]  total_loss: 2.982  soft_target_cross_entropy_loss: 1.548  loss_ofl: 1.468  mask_loss: 0  time: 0.7669  data_time: 0.0452  lr: 7.5935e-05  max_mem: 21179M
[07/04 20:13:24] pts.utils.events INFO:  eta: 0:47:29  iter: 8099 -- [70/259]  total_loss: 3.136  soft_target_cross_entropy_loss: 1.648  loss_ofl: 1.445  mask_loss: 0  time: 0.7666  data_time: 0.1790  lr: 7.4637e-05  max_mem: 21179M
[07/04 20:14:01] pts.utils.events INFO:  eta: 0:46:57  iter: 8149 -- [120/259]  total_loss: 3.259  soft_target_cross_entropy_loss: 1.734  loss_ofl: 1.58  mask_loss: 0  time: 0.7663  data_time: 0.0860  lr: 7.3345e-05  max_mem: 21179M
[07/04 20:14:40] pts.utils.events INFO:  eta: 0:46:29  iter: 8199 -- [170/259]  total_loss: 3.104  soft_target_cross_entropy_loss: 1.556  loss_ofl: 1.48  mask_loss: 0  time: 0.7663  data_time: 0.1358  lr: 7.2057e-05  max_mem: 21179M
[07/04 20:15:15] pts.utils.events INFO:  eta: 0:45:59  iter: 8249 -- [220/259]  total_loss: 3.041  soft_target_cross_entropy_loss: 1.631  loss_ofl: 1.415  mask_loss: 0  time: 0.7658  data_time: 0.0727  lr: 7.0775e-05  max_mem: 21179M
[07/04 20:15:42] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:16:06] pts.utils.events INFO:  eta: 0:45:32  iter: 8299 -- [11/259]  total_loss: 3.1  soft_target_cross_entropy_loss: 1.595  loss_ofl: 1.474  mask_loss: 0  time: 0.7671  data_time: 0.8518  lr: 6.9498e-05  max_mem: 21179M
[07/04 20:16:40] pts.utils.events INFO:  eta: 0:45:01  iter: 8349 -- [61/259]  total_loss: 3.018  soft_target_cross_entropy_loss: 1.564  loss_ofl: 1.439  mask_loss: 0  time: 0.7664  data_time: 0.0500  lr: 6.8226e-05  max_mem: 21179M
[07/04 20:17:14] pts.utils.events INFO:  eta: 0:44:33  iter: 8399 -- [111/259]  total_loss: 3.022  soft_target_cross_entropy_loss: 1.55  loss_ofl: 1.462  mask_loss: 0  time: 0.7659  data_time: 0.0762  lr: 6.6961e-05  max_mem: 21179M
[07/04 20:17:49] pts.utils.events INFO:  eta: 0:44:04  iter: 8449 -- [161/259]  total_loss: 3.067  soft_target_cross_entropy_loss: 1.643  loss_ofl: 1.5  mask_loss: 0  time: 0.7654  data_time: 0.0321  lr: 6.5701e-05  max_mem: 21179M
[07/04 20:18:22] pts.utils.events INFO:  eta: 0:43:32  iter: 8499 -- [211/259]  total_loss: 3.204  soft_target_cross_entropy_loss: 1.727  loss_ofl: 1.478  mask_loss: 0  time: 0.7647  data_time: 0.0221  lr: 6.4448e-05  max_mem: 21179M
[07/04 20:19:01] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:19:19] pts.utils.events INFO:  eta: 0:43:03  iter: 8549 -- [2/259]  total_loss: 3.029  soft_target_cross_entropy_loss: 1.603  loss_ofl: 1.431  mask_loss: 0  time: 0.7667  data_time: 0.9117  lr: 6.3202e-05  max_mem: 21179M
[07/04 20:19:54] pts.utils.events INFO:  eta: 0:42:33  iter: 8599 -- [52/259]  total_loss: 3.035  soft_target_cross_entropy_loss: 1.586  loss_ofl: 1.445  mask_loss: 0  time: 0.7662  data_time: 0.0644  lr: 6.1962e-05  max_mem: 21179M
[07/04 20:20:31] pts.utils.events INFO:  eta: 0:42:01  iter: 8649 -- [102/259]  total_loss: 3.039  soft_target_cross_entropy_loss: 1.568  loss_ofl: 1.501  mask_loss: 0  time: 0.7660  data_time: 0.1997  lr: 6.0729e-05  max_mem: 21179M
[07/04 20:21:12] pts.utils.events INFO:  eta: 0:41:28  iter: 8699 -- [152/259]  total_loss: 3.125  soft_target_cross_entropy_loss: 1.643  loss_ofl: 1.493  mask_loss: 0  time: 0.7662  data_time: 0.1440  lr: 5.9504e-05  max_mem: 21179M
[07/04 20:21:49] pts.utils.events INFO:  eta: 0:40:57  iter: 8749 -- [202/259]  total_loss: 2.994  soft_target_cross_entropy_loss: 1.608  loss_ofl: 1.383  mask_loss: 0  time: 0.7660  data_time: 0.0187  lr: 5.8285e-05  max_mem: 21179M
[07/04 20:22:24] pts.utils.events INFO:  eta: 0:40:34  iter: 8799 -- [252/259]  total_loss: 3.017  soft_target_cross_entropy_loss: 1.54  loss_ofl: 1.452  mask_loss: 0  time: 0.7656  data_time: 0.1742  lr: 5.7075e-05  max_mem: 21179M
[07/04 20:22:28] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:23:13] pts.utils.events INFO:  eta: 0:40:07  iter: 8849 -- [43/259]  total_loss: 3.061  soft_target_cross_entropy_loss: 1.548  loss_ofl: 1.48  mask_loss: 0  time: 0.7665  data_time: 0.1330  lr: 5.5872e-05  max_mem: 21179M
[07/04 20:23:49] pts.utils.events INFO:  eta: 0:39:38  iter: 8899 -- [93/259]  total_loss: 2.981  soft_target_cross_entropy_loss: 1.515  loss_ofl: 1.453  mask_loss: 0  time: 0.7662  data_time: 0.1435  lr: 5.4678e-05  max_mem: 21179M
[07/04 20:24:23] pts.utils.events INFO:  eta: 0:39:08  iter: 8949 -- [143/259]  total_loss: 2.966  soft_target_cross_entropy_loss: 1.499  loss_ofl: 1.443  mask_loss: 0  time: 0.7656  data_time: 0.0606  lr: 5.3492e-05  max_mem: 21179M
[07/04 20:25:01] pts.utils.events INFO:  eta: 0:38:40  iter: 8999 -- [193/259]  total_loss: 3.002  soft_target_cross_entropy_loss: 1.526  loss_ofl: 1.477  mask_loss: 0  time: 0.7655  data_time: 0.0927  lr: 5.2314e-05  max_mem: 21179M
[07/04 20:25:36] pts.utils.events INFO:  eta: 0:38:10  iter: 9049 -- [243/259]  total_loss: 3.123  soft_target_cross_entropy_loss: 1.7  loss_ofl: 1.453  mask_loss: 0  time: 0.7651  data_time: 0.1129  lr: 5.1145e-05  max_mem: 21179M
[07/04 20:26:53] pts.engine.hooks INFO: ############################## Test: 35 ##############################
[07/04 20:26:53] pts.engine.hooks INFO: ACC-1crop@1: 0.6711176633834839
[07/04 20:26:53] pts.engine.hooks INFO: ACC-1crop@5: 0.9233431816101074
[07/04 20:26:53] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:27:32] pts.utils.events INFO:  eta: 0:37:39  iter: 9099 -- [34/259]  total_loss: 2.894  soft_target_cross_entropy_loss: 1.487  loss_ofl: 1.429  mask_loss: 0  time: 0.7664  data_time: 0.0995  lr: 4.9985e-05  max_mem: 21179M
[07/04 20:28:06] pts.utils.events INFO:  eta: 0:37:09  iter: 9149 -- [84/259]  total_loss: 2.96  soft_target_cross_entropy_loss: 1.515  loss_ofl: 1.428  mask_loss: 0  time: 0.7659  data_time: 0.1031  lr: 4.8835e-05  max_mem: 21179M
[07/04 20:28:43] pts.utils.events INFO:  eta: 0:36:39  iter: 9199 -- [134/259]  total_loss: 3.068  soft_target_cross_entropy_loss: 1.6  loss_ofl: 1.5  mask_loss: 0  time: 0.7657  data_time: 0.1001  lr: 4.7693e-05  max_mem: 21179M
[07/04 20:29:19] pts.utils.events INFO:  eta: 0:36:11  iter: 9249 -- [184/259]  total_loss: 3.035  soft_target_cross_entropy_loss: 1.568  loss_ofl: 1.483  mask_loss: 0  time: 0.7653  data_time: 0.0002  lr: 4.6562e-05  max_mem: 21179M
[07/04 20:29:55] pts.utils.events INFO:  eta: 0:35:42  iter: 9299 -- [234/259]  total_loss: 3.028  soft_target_cross_entropy_loss: 1.512  loss_ofl: 1.43  mask_loss: 0  time: 0.7650  data_time: 0.0325  lr: 4.544e-05  max_mem: 21179M
[07/04 20:30:15] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:30:49] pts.utils.events INFO:  eta: 0:35:13  iter: 9349 -- [25/259]  total_loss: 3.039  soft_target_cross_entropy_loss: 1.543  loss_ofl: 1.443  mask_loss: 0  time: 0.7665  data_time: 0.0749  lr: 4.4328e-05  max_mem: 21179M
[07/04 20:31:25] pts.utils.events INFO:  eta: 0:34:41  iter: 9399 -- [75/259]  total_loss: 2.896  soft_target_cross_entropy_loss: 1.488  loss_ofl: 1.44  mask_loss: 0  time: 0.7662  data_time: 0.0725  lr: 4.3226e-05  max_mem: 21179M
[07/04 20:31:59] pts.utils.events INFO:  eta: 0:34:09  iter: 9449 -- [125/259]  total_loss: 2.85  soft_target_cross_entropy_loss: 1.462  loss_ofl: 1.363  mask_loss: 0  time: 0.7657  data_time: 0.0564  lr: 4.2135e-05  max_mem: 21179M
[07/04 20:32:35] pts.utils.events INFO:  eta: 0:33:42  iter: 9499 -- [175/259]  total_loss: 2.844  soft_target_cross_entropy_loss: 1.502  loss_ofl: 1.372  mask_loss: 0  time: 0.7654  data_time: 0.0729  lr: 4.1054e-05  max_mem: 21179M
[07/04 20:33:13] pts.utils.events INFO:  eta: 0:33:16  iter: 9549 -- [225/259]  total_loss: 2.942  soft_target_cross_entropy_loss: 1.537  loss_ofl: 1.435  mask_loss: 0  time: 0.7652  data_time: 0.0376  lr: 3.9984e-05  max_mem: 21179M
[07/04 20:33:38] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:34:06] pts.utils.events INFO:  eta: 0:32:47  iter: 9599 -- [16/259]  total_loss: 2.86  soft_target_cross_entropy_loss: 1.479  loss_ofl: 1.394  mask_loss: 0  time: 0.7665  data_time: 0.8694  lr: 3.8925e-05  max_mem: 21179M
[07/04 20:34:41] pts.utils.events INFO:  eta: 0:32:19  iter: 9649 -- [66/259]  total_loss: 2.908  soft_target_cross_entropy_loss: 1.548  loss_ofl: 1.418  mask_loss: 0  time: 0.7662  data_time: 0.1542  lr: 3.7877e-05  max_mem: 21179M
[07/04 20:35:14] pts.utils.events INFO:  eta: 0:31:51  iter: 9699 -- [116/259]  total_loss: 3.022  soft_target_cross_entropy_loss: 1.609  loss_ofl: 1.466  mask_loss: 0  time: 0.7656  data_time: 0.0153  lr: 3.6841e-05  max_mem: 21179M
[07/04 20:35:54] pts.utils.events INFO:  eta: 0:31:23  iter: 9749 -- [166/259]  total_loss: 2.988  soft_target_cross_entropy_loss: 1.485  loss_ofl: 1.473  mask_loss: 0  time: 0.7656  data_time: 0.1783  lr: 3.5816e-05  max_mem: 21179M
[07/04 20:36:32] pts.utils.events INFO:  eta: 0:30:52  iter: 9799 -- [216/259]  total_loss: 2.957  soft_target_cross_entropy_loss: 1.554  loss_ofl: 1.434  mask_loss: 0  time: 0.7655  data_time: 0.1570  lr: 3.4803e-05  max_mem: 21179M
[07/04 20:37:01] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:37:21] pts.utils.events INFO:  eta: 0:30:24  iter: 9849 -- [7/259]  total_loss: 2.845  soft_target_cross_entropy_loss: 1.448  loss_ofl: 1.403  mask_loss: 0  time: 0.7665  data_time: 0.8574  lr: 3.3802e-05  max_mem: 21179M
[07/04 20:37:55] pts.utils.events INFO:  eta: 0:29:52  iter: 9899 -- [57/259]  total_loss: 2.986  soft_target_cross_entropy_loss: 1.558  loss_ofl: 1.479  mask_loss: 0  time: 0.7659  data_time: 0.0160  lr: 3.2813e-05  max_mem: 21179M
[07/04 20:38:29] pts.utils.events INFO:  eta: 0:29:22  iter: 9949 -- [107/259]  total_loss: 2.914  soft_target_cross_entropy_loss: 1.561  loss_ofl: 1.455  mask_loss: 0  time: 0.7654  data_time: 0.0276  lr: 3.1836e-05  max_mem: 21179M
[07/04 20:39:04] pts.utils.events INFO:  eta: 0:28:53  iter: 9999 -- [157/259]  total_loss: 2.886  soft_target_cross_entropy_loss: 1.498  loss_ofl: 1.415  mask_loss: 0  time: 0.7650  data_time: 0.1291  lr: 3.0872e-05  max_mem: 21179M
[07/04 20:39:40] pts.utils.events INFO:  eta: 0:28:26  iter: 10049 -- [207/259]  total_loss: 2.76  soft_target_cross_entropy_loss: 1.382  loss_ofl: 1.399  mask_loss: 0  time: 0.7647  data_time: 0.0842  lr: 2.992e-05  max_mem: 21179M
[07/04 20:40:19] pts.utils.events INFO:  eta: 0:27:57  iter: 10099 -- [257/259]  total_loss: 2.914  soft_target_cross_entropy_loss: 1.54  loss_ofl: 1.408  mask_loss: 0  time: 0.7648  data_time: 0.2949  lr: 2.8982e-05  max_mem: 21179M
[07/04 20:40:20] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:41:13] pts.utils.events INFO:  eta: 0:27:28  iter: 10149 -- [48/259]  total_loss: 2.89  soft_target_cross_entropy_loss: 1.469  loss_ofl: 1.455  mask_loss: 0  time: 0.7661  data_time: 0.0751  lr: 2.8056e-05  max_mem: 21179M
[07/04 20:41:50] pts.utils.events INFO:  eta: 0:26:57  iter: 10199 -- [98/259]  total_loss: 2.87  soft_target_cross_entropy_loss: 1.442  loss_ofl: 1.407  mask_loss: 0  time: 0.7659  data_time: 0.0251  lr: 2.7143e-05  max_mem: 21179M
[07/04 20:42:27] pts.utils.events INFO:  eta: 0:26:27  iter: 10249 -- [148/259]  total_loss: 2.888  soft_target_cross_entropy_loss: 1.539  loss_ofl: 1.398  mask_loss: 0  time: 0.7657  data_time: 0.0845  lr: 2.6244e-05  max_mem: 21179M
[07/04 20:43:03] pts.utils.events INFO:  eta: 0:25:58  iter: 10299 -- [198/259]  total_loss: 2.904  soft_target_cross_entropy_loss: 1.495  loss_ofl: 1.458  mask_loss: 0  time: 0.7655  data_time: 0.1121  lr: 2.5358e-05  max_mem: 21179M
[07/04 20:43:35] pts.utils.events INFO:  eta: 0:25:30  iter: 10349 -- [248/259]  total_loss: 2.819  soft_target_cross_entropy_loss: 1.534  loss_ofl: 1.394  mask_loss: 0  time: 0.7648  data_time: 0.0002  lr: 2.4486e-05  max_mem: 21179M
[07/04 20:44:47] pts.engine.hooks INFO: ############################## Test: 40 ##############################
[07/04 20:44:47] pts.engine.hooks INFO: ACC-1crop@1: 0.6691394448280334
[07/04 20:44:47] pts.engine.hooks INFO: ACC-1crop@5: 0.9104846119880676
[07/04 20:44:47] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:45:29] pts.utils.events INFO:  eta: 0:25:00  iter: 10399 -- [39/259]  total_loss: 2.892  soft_target_cross_entropy_loss: 1.505  loss_ofl: 1.415  mask_loss: 0  time: 0.7656  data_time: 0.0881  lr: 2.3627e-05  max_mem: 21179M
[07/04 20:46:04] pts.utils.events INFO:  eta: 0:24:30  iter: 10449 -- [89/259]  total_loss: 2.757  soft_target_cross_entropy_loss: 1.377  loss_ofl: 1.392  mask_loss: 0  time: 0.7652  data_time: 0.0608  lr: 2.2783e-05  max_mem: 21179M
[07/04 20:46:43] pts.utils.events INFO:  eta: 0:23:59  iter: 10499 -- [139/259]  total_loss: 2.935  soft_target_cross_entropy_loss: 1.473  loss_ofl: 1.404  mask_loss: 0  time: 0.7652  data_time: 0.2975  lr: 2.1953e-05  max_mem: 21179M
[07/04 20:47:20] pts.utils.events INFO:  eta: 0:23:28  iter: 10549 -- [189/259]  total_loss: 2.843  soft_target_cross_entropy_loss: 1.426  loss_ofl: 1.4  mask_loss: 0  time: 0.7651  data_time: 0.1933  lr: 2.1137e-05  max_mem: 21179M
[07/04 20:47:53] pts.utils.events INFO:  eta: 0:22:57  iter: 10599 -- [239/259]  total_loss: 2.934  soft_target_cross_entropy_loss: 1.529  loss_ofl: 1.356  mask_loss: 0  time: 0.7645  data_time: 0.0723  lr: 2.0335e-05  max_mem: 21179M
[07/04 20:49:09] pts.engine.hooks INFO: ############################## Test: 41 ##############################
[07/04 20:49:09] pts.engine.hooks INFO: ACC-1crop@1: 0.6651829481124878
[07/04 20:49:09] pts.engine.hooks INFO: ACC-1crop@5: 0.9085063934326172
[07/04 20:49:09] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:49:48] pts.utils.events INFO:  eta: 0:22:28  iter: 10649 -- [30/259]  total_loss: 2.955  soft_target_cross_entropy_loss: 1.52  loss_ofl: 1.429  mask_loss: 0  time: 0.7655  data_time: 0.0960  lr: 1.9548e-05  max_mem: 21179M
[07/04 20:50:24] pts.utils.events INFO:  eta: 0:21:57  iter: 10699 -- [80/259]  total_loss: 2.828  soft_target_cross_entropy_loss: 1.471  loss_ofl: 1.372  mask_loss: 0  time: 0.7653  data_time: 0.1185  lr: 1.8776e-05  max_mem: 21179M
[07/04 20:51:03] pts.utils.events INFO:  eta: 0:21:26  iter: 10749 -- [130/259]  total_loss: 2.934  soft_target_cross_entropy_loss: 1.462  loss_ofl: 1.455  mask_loss: 0  time: 0.7653  data_time: 0.1402  lr: 1.8018e-05  max_mem: 21179M
[07/04 20:51:38] pts.utils.events INFO:  eta: 0:20:56  iter: 10799 -- [180/259]  total_loss: 2.924  soft_target_cross_entropy_loss: 1.503  loss_ofl: 1.443  mask_loss: 0  time: 0.7649  data_time: 0.0270  lr: 1.7276e-05  max_mem: 21179M
[07/04 20:52:13] pts.utils.events INFO:  eta: 0:20:27  iter: 10849 -- [230/259]  total_loss: 2.822  soft_target_cross_entropy_loss: 1.397  loss_ofl: 1.391  mask_loss: 0  time: 0.7645  data_time: 0.0395  lr: 1.6548e-05  max_mem: 21179M
[07/04 20:53:35] pts.engine.hooks INFO: ############################## Test: 42 ##############################
[07/04 20:53:35] pts.engine.hooks INFO: ACC-1crop@1: 0.6656774878501892
[07/04 20:53:35] pts.engine.hooks INFO: ACC-1crop@5: 0.9065281748771667
[07/04 20:53:35] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:54:06] pts.utils.events INFO:  eta: 0:19:59  iter: 10899 -- [21/259]  total_loss: 2.919  soft_target_cross_entropy_loss: 1.518  loss_ofl: 1.428  mask_loss: 0  time: 0.7654  data_time: 0.1222  lr: 1.5836e-05  max_mem: 21179M
[07/04 20:54:42] pts.utils.events INFO:  eta: 0:19:27  iter: 10949 -- [71/259]  total_loss: 2.904  soft_target_cross_entropy_loss: 1.507  loss_ofl: 1.409  mask_loss: 0  time: 0.7651  data_time: 0.0741  lr: 1.5139e-05  max_mem: 21179M
[07/04 20:55:21] pts.utils.events INFO:  eta: 0:18:56  iter: 10999 -- [121/259]  total_loss: 2.824  soft_target_cross_entropy_loss: 1.448  loss_ofl: 1.393  mask_loss: 0  time: 0.7652  data_time: 0.2672  lr: 1.4458e-05  max_mem: 21179M
[07/04 20:55:57] pts.utils.events INFO:  eta: 0:18:26  iter: 11049 -- [171/259]  total_loss: 2.821  soft_target_cross_entropy_loss: 1.403  loss_ofl: 1.411  mask_loss: 0  time: 0.7649  data_time: 0.0885  lr: 1.3793e-05  max_mem: 21179M
[07/04 20:56:31] pts.utils.events INFO:  eta: 0:17:57  iter: 11099 -- [221/259]  total_loss: 2.831  soft_target_cross_entropy_loss: 1.509  loss_ofl: 1.349  mask_loss: 0  time: 0.7645  data_time: 0.1272  lr: 1.3143e-05  max_mem: 21179M
[07/04 20:58:01] pts.engine.hooks INFO: ############################## Test: 43 ##############################
[07/04 20:58:01] pts.engine.hooks INFO: ACC-1crop@1: 0.6671611666679382
[07/04 20:58:01] pts.engine.hooks INFO: ACC-1crop@5: 0.9035608172416687
[07/04 20:58:01] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 20:58:26] pts.utils.events INFO:  eta: 0:17:28  iter: 11149 -- [12/259]  total_loss: 2.898  soft_target_cross_entropy_loss: 1.507  loss_ofl: 1.438  mask_loss: 0  time: 0.7654  data_time: 0.8796  lr: 1.2509e-05  max_mem: 21179M
[07/04 20:59:04] pts.utils.events INFO:  eta: 0:16:59  iter: 11199 -- [62/259]  total_loss: 2.937  soft_target_cross_entropy_loss: 1.504  loss_ofl: 1.446  mask_loss: 0  time: 0.7653  data_time: 0.1427  lr: 1.1891e-05  max_mem: 21179M
[07/04 20:59:38] pts.utils.events INFO:  eta: 0:16:29  iter: 11249 -- [112/259]  total_loss: 2.905  soft_target_cross_entropy_loss: 1.493  loss_ofl: 1.415  mask_loss: 0  time: 0.7648  data_time: 0.1083  lr: 1.1289e-05  max_mem: 21179M
[07/04 21:00:16] pts.utils.events INFO:  eta: 0:16:00  iter: 11299 -- [162/259]  total_loss: 2.909  soft_target_cross_entropy_loss: 1.494  loss_ofl: 1.396  mask_loss: 0  time: 0.7647  data_time: 0.1348  lr: 1.0703e-05  max_mem: 21179M
[07/04 21:00:55] pts.utils.events INFO:  eta: 0:15:31  iter: 11349 -- [212/259]  total_loss: 2.821  soft_target_cross_entropy_loss: 1.484  loss_ofl: 1.368  mask_loss: 0  time: 0.7647  data_time: 0.2250  lr: 1.0133e-05  max_mem: 21179M
[07/04 21:02:32] pts.engine.hooks INFO: ############################## Test: 44 ##############################
[07/04 21:02:32] pts.engine.hooks INFO: ACC-1crop@1: 0.6661720871925354
[07/04 21:02:32] pts.engine.hooks INFO: ACC-1crop@5: 0.9020771384239197
[07/04 21:02:32] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 21:02:52] pts.utils.events INFO:  eta: 0:15:02  iter: 11399 -- [3/259]  total_loss: 2.787  soft_target_cross_entropy_loss: 1.488  loss_ofl: 1.302  mask_loss: 4.697e-06  time: 0.7657  data_time: 0.9292  lr: 9.5804e-06  max_mem: 21179M
[07/04 21:03:29] pts.utils.events INFO:  eta: 0:14:33  iter: 11449 -- [53/259]  total_loss: 2.888  soft_target_cross_entropy_loss: 1.485  loss_ofl: 1.425  mask_loss: 0  time: 0.7655  data_time: 0.1220  lr: 9.0439e-06  max_mem: 21179M
[07/04 21:04:07] pts.utils.events INFO:  eta: 0:14:04  iter: 11499 -- [103/259]  total_loss: 2.828  soft_target_cross_entropy_loss: 1.513  loss_ofl: 1.425  mask_loss: 0  time: 0.7655  data_time: 0.2745  lr: 8.524e-06  max_mem: 21179M
[07/04 21:04:42] pts.utils.events INFO:  eta: 0:13:35  iter: 11549 -- [153/259]  total_loss: 2.924  soft_target_cross_entropy_loss: 1.52  loss_ofl: 1.452  mask_loss: 0  time: 0.7651  data_time: 0.0680  lr: 8.0208e-06  max_mem: 21179M
[07/04 21:05:19] pts.utils.events INFO:  eta: 0:13:06  iter: 11599 -- [203/259]  total_loss: 2.775  soft_target_cross_entropy_loss: 1.426  loss_ofl: 1.369  mask_loss: 0  time: 0.7649  data_time: 0.2482  lr: 7.5345e-06  max_mem: 21179M
[07/04 21:05:52] pts.utils.events INFO:  eta: 0:12:38  iter: 11649 -- [253/259]  total_loss: 2.762  soft_target_cross_entropy_loss: 1.392  loss_ofl: 1.394  mask_loss: 0  time: 0.7644  data_time: 0.0606  lr: 7.065e-06  max_mem: 21179M
[07/04 21:06:59] pts.engine.hooks INFO: ############################## Test: 45 ##############################
[07/04 21:06:59] pts.engine.hooks INFO: ACC-1crop@1: 0.6651829481124878
[07/04 21:06:59] pts.engine.hooks INFO: ACC-1crop@5: 0.9010879993438721
[07/04 21:06:59] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 21:07:47] pts.utils.events INFO:  eta: 0:12:09  iter: 11699 -- [44/259]  total_loss: 2.889  soft_target_cross_entropy_loss: 1.427  loss_ofl: 1.447  mask_loss: 0  time: 0.7653  data_time: 0.1007  lr: 6.6124e-06  max_mem: 21179M
[07/04 21:08:29] pts.utils.events INFO:  eta: 0:11:40  iter: 11749 -- [94/259]  total_loss: 2.782  soft_target_cross_entropy_loss: 1.464  loss_ofl: 1.328  mask_loss: 0  time: 0.7656  data_time: 0.1479  lr: 6.177e-06  max_mem: 21179M
[07/04 21:09:04] pts.utils.events INFO:  eta: 0:11:11  iter: 11799 -- [144/259]  total_loss: 2.791  soft_target_cross_entropy_loss: 1.466  loss_ofl: 1.348  mask_loss: 0  time: 0.7652  data_time: 0.0573  lr: 5.7586e-06  max_mem: 21179M
[07/04 21:09:41] pts.utils.events INFO:  eta: 0:10:42  iter: 11849 -- [194/259]  total_loss: 2.743  soft_target_cross_entropy_loss: 1.401  loss_ofl: 1.37  mask_loss: 0  time: 0.7651  data_time: 0.0737  lr: 5.3575e-06  max_mem: 21179M
[07/04 21:10:17] pts.utils.events INFO:  eta: 0:10:13  iter: 11899 -- [244/259]  total_loss: 2.752  soft_target_cross_entropy_loss: 1.401  loss_ofl: 1.342  mask_loss: 0  time: 0.7648  data_time: 0.0900  lr: 4.9736e-06  max_mem: 21179M
[07/04 21:11:35] pts.engine.hooks INFO: ############################## Test: 46 ##############################
[07/04 21:11:35] pts.engine.hooks INFO: ACC-1crop@1: 0.6636992692947388
[07/04 21:11:35] pts.engine.hooks INFO: ACC-1crop@5: 0.8991097807884216
[07/04 21:11:35] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 21:12:13] pts.utils.events INFO:  eta: 0:09:45  iter: 11949 -- [35/259]  total_loss: 2.826  soft_target_cross_entropy_loss: 1.498  loss_ofl: 1.4  mask_loss: 0  time: 0.7656  data_time: 0.0425  lr: 4.6071e-06  max_mem: 21179M
[07/04 21:12:49] pts.utils.events INFO:  eta: 0:09:15  iter: 11999 -- [85/259]  total_loss: 2.721  soft_target_cross_entropy_loss: 1.393  loss_ofl: 1.333  mask_loss: 0  time: 0.7653  data_time: 0.0373  lr: 4.258e-06  max_mem: 21179M
[07/04 21:13:26] pts.utils.events INFO:  eta: 0:08:46  iter: 12049 -- [135/259]  total_loss: 2.895  soft_target_cross_entropy_loss: 1.477  loss_ofl: 1.402  mask_loss: 0  time: 0.7652  data_time: 0.0883  lr: 3.9264e-06  max_mem: 21179M
[07/04 21:14:00] pts.utils.events INFO:  eta: 0:08:17  iter: 12099 -- [185/259]  total_loss: 2.769  soft_target_cross_entropy_loss: 1.432  loss_ofl: 1.3  mask_loss: 0  time: 0.7648  data_time: 0.1239  lr: 3.6124e-06  max_mem: 21179M
[07/04 21:14:37] pts.utils.events INFO:  eta: 0:07:48  iter: 12149 -- [235/259]  total_loss: 2.834  soft_target_cross_entropy_loss: 1.478  loss_ofl: 1.366  mask_loss: 0  time: 0.7646  data_time: 0.0673  lr: 3.3159e-06  max_mem: 21179M
[07/04 21:15:56] pts.engine.hooks INFO: ############################## Test: 47 ##############################
[07/04 21:15:56] pts.engine.hooks INFO: ACC-1crop@1: 0.6602373719215393
[07/04 21:15:56] pts.engine.hooks INFO: ACC-1crop@5: 0.898120641708374
[07/04 21:15:56] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 21:16:32] pts.utils.events INFO:  eta: 0:07:19  iter: 12199 -- [26/259]  total_loss: 2.833  soft_target_cross_entropy_loss: 1.446  loss_ofl: 1.387  mask_loss: 0  time: 0.7655  data_time: 0.1586  lr: 3.0371e-06  max_mem: 21179M
[07/04 21:17:06] pts.utils.events INFO:  eta: 0:06:49  iter: 12249 -- [76/259]  total_loss: 2.796  soft_target_cross_entropy_loss: 1.443  loss_ofl: 1.362  mask_loss: 0  time: 0.7651  data_time: 0.0336  lr: 2.776e-06  max_mem: 21179M
[07/04 21:17:41] pts.utils.events INFO:  eta: 0:06:20  iter: 12299 -- [126/259]  total_loss: 2.873  soft_target_cross_entropy_loss: 1.45  loss_ofl: 1.421  mask_loss: 0  time: 0.7647  data_time: 0.0693  lr: 2.5327e-06  max_mem: 21179M
[07/04 21:18:20] pts.utils.events INFO:  eta: 0:05:51  iter: 12349 -- [176/259]  total_loss: 2.813  soft_target_cross_entropy_loss: 1.482  loss_ofl: 1.333  mask_loss: 0  time: 0.7648  data_time: 0.1728  lr: 2.3071e-06  max_mem: 21179M
[07/04 21:18:55] pts.utils.events INFO:  eta: 0:05:21  iter: 12399 -- [226/259]  total_loss: 2.855  soft_target_cross_entropy_loss: 1.451  loss_ofl: 1.379  mask_loss: 0  time: 0.7645  data_time: 0.0554  lr: 2.0994e-06  max_mem: 21179M
[07/04 21:20:24] pts.engine.hooks INFO: ############################## Test: 48 ##############################
[07/04 21:20:24] pts.engine.hooks INFO: ACC-1crop@1: 0.6607319116592407
[07/04 21:20:24] pts.engine.hooks INFO: ACC-1crop@5: 0.8976260423660278
[07/04 21:20:24] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 21:20:53] pts.utils.events INFO:  eta: 0:04:52  iter: 12449 -- [17/259]  total_loss: 2.898  soft_target_cross_entropy_loss: 1.509  loss_ofl: 1.404  mask_loss: 0  time: 0.7654  data_time: 0.9489  lr: 1.9095e-06  max_mem: 21179M
[07/04 21:21:28] pts.utils.events INFO:  eta: 0:04:23  iter: 12499 -- [67/259]  total_loss: 2.799  soft_target_cross_entropy_loss: 1.409  loss_ofl: 1.381  mask_loss: 0  time: 0.7651  data_time: 0.1421  lr: 1.7376e-06  max_mem: 21179M
[07/04 21:22:04] pts.utils.events INFO:  eta: 0:03:54  iter: 12549 -- [117/259]  total_loss: 2.794  soft_target_cross_entropy_loss: 1.457  loss_ofl: 1.3  mask_loss: 0  time: 0.7649  data_time: 0.2115  lr: 1.5836e-06  max_mem: 21179M
[07/04 21:22:41] pts.utils.events INFO:  eta: 0:03:24  iter: 12599 -- [167/259]  total_loss: 2.761  soft_target_cross_entropy_loss: 1.386  loss_ofl: 1.346  mask_loss: 0  time: 0.7647  data_time: 0.1375  lr: 1.4475e-06  max_mem: 21179M
[07/04 21:23:18] pts.utils.events INFO:  eta: 0:02:55  iter: 12649 -- [217/259]  total_loss: 2.828  soft_target_cross_entropy_loss: 1.454  loss_ofl: 1.369  mask_loss: 0  time: 0.7646  data_time: 0.1744  lr: 1.3295e-06  max_mem: 21179M
[07/04 21:24:49] pts.engine.hooks INFO: ############################## Test: 49 ##############################
[07/04 21:24:49] pts.engine.hooks INFO: ACC-1crop@1: 0.6602373719215393
[07/04 21:24:49] pts.engine.hooks INFO: ACC-1crop@5: 0.8946586847305298
[07/04 21:24:49] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 21:25:11] pts.utils.events INFO:  eta: 0:02:26  iter: 12699 -- [8/259]  total_loss: 2.802  soft_target_cross_entropy_loss: 1.42  loss_ofl: 1.397  mask_loss: 0  time: 0.7652  data_time: 0.8122  lr: 1.2295e-06  max_mem: 21179M
[07/04 21:25:47] pts.utils.events INFO:  eta: 0:01:56  iter: 12749 -- [58/259]  total_loss: 2.84  soft_target_cross_entropy_loss: 1.393  loss_ofl: 1.414  mask_loss: 0  time: 0.7649  data_time: 0.0953  lr: 1.1475e-06  max_mem: 21179M
[07/04 21:26:22] pts.utils.events INFO:  eta: 0:01:27  iter: 12799 -- [108/259]  total_loss: 2.802  soft_target_cross_entropy_loss: 1.48  loss_ofl: 1.381  mask_loss: 0  time: 0.7646  data_time: 0.0802  lr: 1.0835e-06  max_mem: 21179M
[07/04 21:26:55] pts.utils.events INFO:  eta: 0:00:58  iter: 12849 -- [158/259]  total_loss: 2.747  soft_target_cross_entropy_loss: 1.436  loss_ofl: 1.351  mask_loss: 0  time: 0.7642  data_time: 0.1134  lr: 1.0376e-06  max_mem: 21179M
[07/04 21:27:30] pts.utils.events INFO:  eta: 0:00:29  iter: 12899 -- [208/259]  total_loss: 2.757  soft_target_cross_entropy_loss: 1.434  loss_ofl: 1.346  mask_loss: 0  time: 0.7639  data_time: 0.0721  lr: 1.0098e-06  max_mem: 21179M
[07/04 21:29:12] pts.engine.hooks INFO: ############################## Test: 50 ##############################
[07/04 21:29:12] pts.engine.hooks INFO: ACC-1crop@1: 0.6632047295570374
[07/04 21:29:12] pts.engine.hooks INFO: ACC-1crop@5: 0.8941641449928284
[07/04 21:29:12] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/current.pth
[07/04 21:29:13] fvcore.common.checkpoint INFO: Saving checkpoint to experiments/log_eg_swin_s2s+t2t_8gpu_mixlr002/model_final.pth
[07/04 21:29:14] pts.utils.events INFO:  eta: 0:00:00  iter: 12949 -- [258/259]  total_loss: 2.789  soft_target_cross_entropy_loss: 1.464  loss_ofl: 1.354  mask_loss: 0  time: 0.7637  data_time: 0.1579  lr: 1e-06  max_mem: 21179M
[07/04 21:29:14] pts.engine.hooks INFO: Overall training speed: 12948 iterations in 2:44:48 (0.7637 s / it)
[07/04 21:29:14] pts.engine.hooks INFO: Total training time: 3:09:30 (0:24:42 on hooks)
[07/04 21:30:17] pts.engine.hooks INFO: ############################## Test: 50 ##############################
[07/04 21:30:17] pts.engine.hooks INFO: ACC-1crop@1: 0.6627101302146912
[07/04 21:30:17] pts.engine.hooks INFO: ACC-1crop@5: 0.8941641449928284
[07/04 21:30:17] pts.engine.hooks INFO: Best accuracy 68.793%
